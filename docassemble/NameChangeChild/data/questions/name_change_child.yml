 metadata:
  title: Name change for a child
  short title: Child name change
  comment: This program makes the forms to ask the court to change the names of minor children.
  authors:
    - Vivian McNaughton
    - Matt Newsted
---
include:
  - docassemble.AssemblyLine:assembly_line.yml
  - docassemble.ALToolbox:phone-number-validation.yml
  - docassemble.ILAO:ilao-interview-framework.yml
  - docassemble.ILAO:shared-basic-questions.yml
---
objects:
  - users: ALPeopleList.using(there_are_any=True)
  - children: ALPeopleList.using(there_are_any=True, object_type=ALIndividual, complete_attribute=['complete'])
  - children[i].new: ALIndividual
  - children[i].main_other_parent: ALIndividual
  - children[i].parents: ALPeopleList.using(there_are_any=True, object_type=ALIndividual, complete_attribute=['complete'])
  - children[i].birth_place: ALAddress
  #parent_list_generator exists as an list to collect any parents/guardians/custodians of the children who require notice. If a a parent/guardian/custodian does not agree to the name change and the user does not think it is an issue to notify them, they should be added to this list.
  - parent_list_generator: ALPeopleList.using(there_are_any=True, object_Type=ALIndividual, there_is_another=False)
  - published_children: ALPeopleList.using(there_are_any=True, object_Type=ALIndividual, there_is_another=False)
  - children[i].convictions: DAList.using(object_type=Thing, there_are_any=True)
  - court_list: ALCourtLoader.using(file_name='docassemble.ILAO:data/sources/il_courts.xlsx')
  - children[i].orders: DAList.using(object_type=Thing, complete_attribute='complete', there_are_any=True)
  - debug_list: ALPeopleList.using(there_are_any=True, object_Type=ALIndividual, there_is_another=False)
  - included_children: ALPeopleList.using(there_are_any=True, object_Type=ALIndividual, there_is_another=False)
---
# Road map
sections:
  - section_intro: Start
  - section_user: Your information
  - section_children: Children and parents
  - section_notice: Notice
  - section_filing: Filing
  - section_download: Download
---
code: |
  ilao_easy_form_title = "Name change for a child"
  ilao_easy_form_url = "https://www.illinoislegalaid.org/legal-information/name-change-child"
  github_user = 'IllinoisLegalAidOnline'
  github_repo_name = 'docassemble-NameChangeChild'
  allowed_courts = ['Circuit']
---
# interview order block
mandatory: True
code: |
  interview_type = "child"
  nav.set_section('section_intro')
  sees_nav_bar
  snapshot_start
  how_to_use
  set_progress(5)
  whats_next
  accept_terms
  #refresh_code_block is flipped in some validation code to ensure adding
  refresh_code_block = False
  
  nav.set_section('section_user')
  if user_is_adult == False:
    not_an_adult_kickout
  if six_months_in_illinois == False:
    not_enough_illinois_kickout
  if time_in_illinois.years < 0.5:
    not_enough_illinois_kickout
  set_progress(20)
  users[0].name.first
  use_safe_address
  users[0].address.address
 
  users[0].has_email_address
    
  nav.set_section('section_children')
  set_progress(40)
  children.gather()
  check_for_skips
  nav.set_section('section_notice')
  for child in children:
    #The code for the child.main_other_parent object should mirror the code in the while loop for each individual in the child.parents list.
    if not child.skip:
      if child.other_parent_status == "deceased_parent":
        child.deceased_info
      elif child.other_parent_status == "has_other_parent":
        child.main_other_parent.name.first
        if child.main_other_parent.rights_terminated == False:
          if child.main_other_parent.agree == True:
            notarized_signature
          else:
            notice_waiver_info
            child.main_other_parent.risk_check
            if child.main_other_parent.risk_check == False:
              if child.main_other_parent.address_known == True:
                child.main_other_parent.receive_method
              else:
                published_notice_info
      if child.any_other_parents == True:
        interview_parent_index = 0
        while interview_parent_index < child.parents.number_gathered():
          if child.parents[interview_parent_index].parent_type != "Parent" or child.parents[interview_parent_index].rights_terminated == False:
            if child.parents[interview_parent_index].agree == True:
              notarized_signature
            else:
              notice_waiver_info
              child.parents[interview_parent_index].risk_check
              if child.parents[interview_parent_index].risk_check == False:
                if child.parents[interview_parent_index].address_known == True:
                  child.parents[interview_parent_index].receive_method
                else:
                  published_notice_info

          interview_parent_index += 1
      #child.waiver_code_block    
  waiver_reason_logic
  set_progress(60)

  #If any parent who needs to be notified poses a risk or if notice by publication would be required but could cause the child a hardship, the questions around motion to waive notice/publication should be asked.
  #if any_risk == True or (child_notice_would_be_published == True and request_waiver == True):
  #  note_about_waiver
  #  if waiver_reason['order'] == True:
  #    if protective_order.any_true():
  #      order_against_parents
  #      orders.gather()
  #  #Following if statement is commented out as the hardship field on the form is available to anyone requesting a waiver.
  #  hardship_text
    
  nav.set_section('section_filing')
  set_progress(80)
  filing_county
  #if trial_court_index == -1 and child_notice_would_be_published == True and (any_risk == False or request_waiver == False):
  #  cook_district
  #if child_notice_would_be_published == True and any_risk == False and request_waiver == False:
  #  courthouse_info
  e_signature
    
  if any_to_notify == True or (child_notice_would_be_published == True and any_risk == False):
    if any_to_notify == True or any_pubish_waiver_requested == False:
      complete_notice
  elif child_notice_would_be_published and not any_risk:
    if not any_pubish_waiver_requested:
      complete_notice
  if any_to_notify == True:
    notice_reminder
  set_progress(100)
  nav.set_section('section_download')
  #enabled_enabler
  pop_skipped_children
  parent_on_child_sheet_logic
  refresh_bundles
  if any_to_notify:
    refresh_notice_bundle
  template_variable_logic
  forms_assembling
  waiver_reason_logic
  snapshot_forms
  get_docs_screen
---
code: |
  stuff_to_snapshot = {
  	'start_time': str(current_datetime().format_datetime()),
  	'started_interview': True, 
  	}
    
  try:
    stuff_to_snapshot['ip_address'] = device(ip=True)
  except:
    pass

  stuff_to_snapshot['user_zip'] = showifdef('users[0].address.zip')

  stuff_to_snapshot['downloaded_forms'] = showifdef('forms_assembling')
  
  stuff_to_snapshot['number_of_children_included'] = showifdef('included_children_count')
  
  stuff_to_snapshot['number_of_children_excluded'] = showifdef('excluded_children_count')
  
  store_variables_snapshot(
  	data=stuff_to_snapshot, persistent=True
  	)
  snapshot_interview_state = True
---
code: |
  snapshot_interview_state
  snapshot_start = True  
---
code: |
  reconsider('snapshot_interview_state')
  snapshot_forms = True
---
#Gather loop for children list
code: |
  children[i].name.first
  children[i].new.name.first
  if children[i].age_in_years() >= 18:
    children[i].too_old
  else:
    if children[i].user_relationship == "other":
      not_parent_or_guardian_kickout
    else:
      if children[i].age_in_years(decimals=True) >= 0.5 and not children[i].six_months_in_illinois:
        children[i].six_month_kickout
      else:
        if children[i].user_relationship == "bio" or children[i].user_relationship == "adopt":
          if children[i].no_parental_rights == True:
            user_terminated_rights_kickout
        if children[i].user_relationship == "guardian":
          children[i].guardian_docs
        children[i].criminal_history_intro
        children[i].pending_arrests
        children[i].pending_charges
        children[i].misdemeanors
        children[i].felonies
        children[i].registry
        if children[i].registry and children[i].registry_exceptions.all_false():
          registry_kickout
        elif children[i].registry:
          registry_notification
        children[i].id_theft
        if children[i].felonies or children[i].registry or children[i].id_theft:
          children[i].conviction_intro
  	      children[i].convictions.gather()
  
        children[i].change_reasons
    
        children[i].birth_place.in_america
        if use_safe_address == True:
          if children[i].use_safe_address == False:
            children[i].address.address
        else:
          children[i].use_safe_address = False
          children[i].address.address
      
    #The way the forms are designed, they allow for a given child to have, in addition to the user, one other parent, one other guardian, and one other custodian. As such, the current program only allows for a the parents list associated with a given child to have 3 entries: 0 for parent, 1 for guardian, and 2 for custodian. Pending SME review, this may be retooled to allow for over 3 parental units per child. Why does this code code block go through each parents[i] individually instead of looping them? Because the program wants to keep a given parent type associated with a specific index. This probably could be done more efficiently with a loop, but I foolishly didn't set it up that way.
      #if children[i].include_other_parent == True: 
      #  children[i].parents[0].name.first
        about_other_parentals
        if children[i].no_main_parent == False:
          
          children[i].main_other_parent.rights_terminated
          if children[i].main_other_parent.address_known == True:
            children[i].main_other_parent.address.address
        elif children[i].other_parent_status == "deceased_parent":
          children[i].deceased_info
        if children[i].any_other_parents == True:
          
          children[i].parents.gather()
          
            
   #Between the name change request form and the additional children form, there are space for 12 children. 
  if i == 11:
    children.there_is_another = False
  children[i].complete = True        
---
#gather parent gather list
code: |
  if showifdef('children[i].skip') == "" or not children[i].skip:
    if children[i].any_other_parents == True:
      children[i].parents[j].name.first
      if children[i].parents[j].parent_type == "Parent":
        children[i].parents[j].rights_terminated
      #if children[i].parents[j].agree == True: 
        #children[i].parents[j].notarized_signature
      if children[i].parents[j].address_known == True:
        children[i].parents[j].address.address
      #if children[i].parents[j].agree != True:
        #children[i].parents[j].notice_waiver_info  
        #if children[i].parents[j].risk_check == False:
          #if children[i].parents[j].address_known == True:
            #children[i].parents[j].receive_method 
        #if children[i].parents[j].agree != True and children[i].parents[j].address_known == False and children[i].parents[j].risk_check == False:
          #children[i].parents[j].published_notice_info 
        #elif children[i].parents[j].agree != True and children[i].parents[j].address_known == True and children[i].parents[j].risk_check == False and children[i].parents[j].receive_method == "newspaper":
          #children[i].parents[j].published_notice_info 
    else:
      children[i].parents.there_is_another = False
      
  children[i].parents[j].complete = True
---
#Used to calculate the amount of time the user has been living in Illinois, which needs to be 6 months or more.
depends on:
  - started_living_in_illinois
code: |
  time_in_illinois = date_difference(starting=started_living_in_illinois, ending=today())
---
id: welcome
question: |
  Name change for a child
subquestion: |
  Welcome to Illinois Legal Aid Online's **Name change for a child** Easy Form.

  This program helps you prepare court forms to change the name of minor children.
  
  The forms you create can only be used in Illinois.
  
  To learn more, read ILAO's article about [**starting a case to change a child's name**](https://www.illinoislegalaid.org/node/30586).
field: sees_nav_bar
---
id: instructions
continue button field: how_to_use
question: |
  Instructions
subquestion: |
  To change a child's name in Illinois: 

  * Your child must be under 18 years old, and 
  * You must have lived in Illinois for at least 6 months.
  
  You will also need details if your child has a criminal history.

  If your child is 18 years old or older, you cannot file a name change on their behalf. They can use ILAO's [**Name change for an adult**](https://www.illinoislegalaid.org/legal-information/name-change-adult) Easy Form.
  
  Set aside 20 to 30 minutes to finish this program. You can log in and save your work to return to later. 
  
  ${ collapse_template(help_example) }  

  Click on **{green words}** to learn what they mean. Some pages have a question mark in a circle ${ fa_icon("question-circle", color_css="#0dcaf0" ) } that helps explain things.
---
template: help_example

subject: |

  **You can click sections like this to show more information.**

content: |  

  This is an example of help. Click again to hide.
---
id: whats next
continue button field: whats_next
question: |
  After you finish this program
subquestion: |
  After you download your forms, you must file them with the court in the county where you live. This program **does not** file your forms for you.
  
  When you file your forms, the court clerk will give you a court date. Usually, you have to notify any of the child's other parents, guardians, or custodians. However, if giving them notice would be a hardship for you or your child, including risking health or safety, you can ask the judge to skip that step by filing a motion to waive notice. This program will help you make the forms you need either way.
  
  To learn more, read the *How to Change a Name for Minor Children* instructions you can download at the end of this program. 
--- 
template: get_legal_help
subject: |
  **What if I need legal advice?**
content: |  
  If you have questions or concerns about your legal problem and want legal advice you should talk to a lawyer.
 
  Use [**Get Legal Help**](https://www.illinoislegalaid.org/get-legal-help) to find free or low-cost legal services in your area.
---
id: user age check
question: |
  Are you 18 years old or older?
fields:
  - no label: user_is_adult
    datatype: yesnoradio
---
id: too young kickout
event: not_an_adult_kickout
question: |
  Sorry
subquestion: |
  Sorry, but you must be at least 18 years old to request a name change for a minor.
  
  If you are a minor and you do not have a parent or guardian to request a name change for you, you may want to [**Get Legal Help**]("https://www.illinoislegalaid.org/get-legal-help").
buttons:
  - Exit: exit
  - Restart: restart
---
id: six months in illinois
question: |
  Have you lived continuously in Illinois for at least 6 months?
subquestion: |
  ${collapse_template(live_continuously)}
fields:
  - no label: six_months_in_illinois
    datatype: yesnoradio
---
template: live_continuously
subject: |
  **What does "lived continuously" mean?** 
content: |
  "Lived continuously" means that you have lived in Illinois without taking a break to live in another state or country.
---
id: not enough time in illinois
event: not_enough_illinois_kickout
question: |
  Sorry
subquestion: |
  You must have lived continuously in Illinois for at least 6 months to use this program.
  
  You can use the [**Legal Services Corporation website**](https://www.lsc.gov/about-lsc/what-legal-aid/get-legal-help) to find a legal aid organization in another state. Or you can use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
buttons:
  - Exit: exit
  - Restart: restart
---
id: child six month kickout
continue button field: children[i].six_month_kickout
question: |
  Sorry
subquestion: |
  ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) must have lived in Illinois for at least 6 months to change their name in Illinois.
  
  You can use the [**Legal Services Corporation website**](https://www.lsc.gov/about-lsc/what-legal-aid/get-legal-help) to find a legal aid organization in another state. Or you can use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
  
  If you want to change the name of a different child, click **Next**.
---
id: time in illinois
question: |
  When did you start living in Illinois?
fields:
  - Date: started_living_in_illinois
    datatype: ThreePartsDate
    alMax: ${today()}
---
id: hide address
question: |
  Do you want to keep your address hidden?
subquestion: |
  You do not need to list your address on your court papers if this would put you or your household at risk.
  
  You can use an address where you can receive court notices instead.
fields:
  - no label: use_safe_address
    datatype: yesnoradio
---
id: user address
question: |
  % if use_safe_address == True:
  What is your mailing address?
  % else:
  What is your home address?
  % endif
subquestion: |
  % if use_safe_address:
  **This address will appear on your court papers.** You may receive court notices and documents about your case at this address.
  % else:
  **This address will appear on your court papers.** If you do not want this, click **Back** to keep your address hidden.
  % endif
fields:
  - Street address: users[0].address.address
    address autocomplete: True
  - Address line 2: users[0].address.unit
    required: False
  - City: users[0].address.city
  - State: users[0].address.state
    code: |
      states_list() 
  - ZIP code: users[0].address.zip
---
id: child name
question: |
  % if i == 0:
  What is the child's current name?
  % else:
  What is the ${ordinal(i)} child's current name?
  % endif
subquestion: |
  This is usually what is listed on their birth certificate.
  % if i == 0:
  
  If you want to change the name of multiple children, you will be able to enter the other children's information on later screens.
  % endif
  
  **Note:** If their legal name has a suffix that is not listed, you can enter it in the **Last name** field with their last name.
fields:
  - First: children[i].name.first
  - Middle: children[i].name.middle
    required: False
  - Last: children[i].name.last
  - Suffix: children[i].name.suffix
    code: |
      name_suffix()
    required: False 
---
id: child birth date
question: |
  When was ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) born?
subquestion: |
  This program can only change the name of a child under the age of 18. To make name change forms for an adult, use ILAO's [**Name change for an adult Easy Form**](https://www.illinoislegalaid.org/node/36321).
fields:
  - Birth date: children[i].birthdate
    datatype: ThreePartsDate
    alMax: ${today().format("yyyy-MM-dd")}
    alMin: ${today().minus(years=18).format("yyyy-MM-dd")}
---
id: child six months
question: |
  Has ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) lived in Illinois for at least 6 months?
subquestion: |
  If ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) has lived in Illinois without taking a break to live in another state or country, click **Yes**.
fields:
  - no label: children[i].six_months_in_illinois
    datatype: yesnoradio
---
id: child too old
continue button field: children[i].too_old
question: |
  Sorry
subquestion: |
  ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) is an adult. If they want to change their name, they will have to do so their self. To make name change forms for an adult, use ILAO's [**Name change for an adult Easy Form**](https://www.illinoislegalaid.org/node/36321).

  If you have another child whose name you would like to change, click **Next**.
---
id: child user relationship
question: |
  What is your relationship to ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})?
field: children[i].user_relationship
choices:
  - I am their biological parent.: bio
  - I am their adoptive parent.: adopt
  - I am their legal guardian.: custody
  - ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) has lived in my home for 3 years and is recognized as my adopted child.: years
  - Other: other
---
id: not parent or guardian kickout
continue button field: not_parent_or_guardian_kickout
question: |
  Sorry
subquestion: |
  Sorry, you can only ask court to change a child’s name if you are their parent or guardian.
  
  If you have another child whose name you would like to change, click **Next**.
---
id: guardian documents
continue button field: children[i].guardian_docs
question: |
  Guardianship documentation
subquestion: |
  You should make a copy of the court order which gave you legal guardianship of ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}).

  Attach a copy of the court order when you file the name change forms with the court.
---
id: child any convictions
question: |
  Has ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) been convicted of or placed on probation for any of the following in Illinois or any other state?
fields:
  - no label: children[i].any_convictions
    datatype: checkboxes
    choices:
      - A crime which requires them to register as a sex offender: register
      - Identity theft or aggravated identity theft: identity
      - A felony: felony
  - Was ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) pardoned of the crime requiring them to register as a sex offender?: children[i].register_pardon 
    show if: children[i].any_convictions['register']
  - Was ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) pardoned of the identity theft or aggravated identity theft?: children[i].identity_pardon
    show if: children[i].any_convictions['identity']
  - Was ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) pardoned of the felony 10 or more years ago?: children[i].felony_pardon
    show if: children[i].any_convictions['felony']
  - Did ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) complete their probation or sentence for their felony 10 or more years ago?: children[i].felony_complete
validation code: |
  children[i].in_need_of_pardon = False
  if children[i].any_convictions['register'] == True:
    if children[i].register_pardon == False:
      children[i].in_need_of_pardon = True
  if children[i].any_convictions['identity'] == True:
    if children[i].identity_pardon == False:
      children[i].in_need_of_pardon = True
  if children[i].any_convictions['felony'] == True:
    if children[i].felony_pardon == False and children[i].felony_complete == False:
      children[i].in_need_of_pardon = True
---
id: child need pardon kickout
continue button field: children[i].need_pardon_kickout
question: |
  Sorry
subquestion: |
  % if children[i].register_pardon == False:
  ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) must have been pardoned for their crime requiring them to register as a sex offender in order to use this program.
  % endif
  % if children[i].identity_pardon == False:
  ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) must have been pardoned for their identity theft crime.
  % endif
  % if children[i].felony_pardon == False and children[i].felony_complete == False:
  ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) must have been pardoned or completed their probation or sentence over 10 years ago.
  % endif
  
  If you want to change the name of a different child, click **Next**.
---
id: child name change reason
question: |
  % if i == 0:
  Why are you changing the child's name from "${children[i].name.full(middle='full')}" to "${children[i].new.name.full(middle='full')}?"
  % else:
  Why are you changing the ${ordinal(i)} child's name from "${children[i].name.full(middle='full')}" to "${children[i].new.name.full(middle='full')}?"
  % endif
subquestion: |
  Check all that apply.
fields:
  - It is in the best interest of the child that their name be changed because:: children[i].change_reasons
    datatype: checkboxes
    none of the above: False
    choices:
      - I want to change their name.: user_wants
      - They want to change their name.: child_wants
      - Other: other
  - Other reasons: children[i].other_reason
    input type: area
    rows: 7
    maxlength: 250
    show if: children[i].change_reasons['other']
---
id: child new name
question: |
  What would you like to change ${children[i].name.full(middle='full')}'s name to?
subquestion: |
  **Note:** If their new name uses a suffix that is not listed, you can enter it in the **Last name** field with their last name.
fields:
  - First: children[i].new.name.first
  - Middle: children[i].new.name.middle
    required: False
  - Last: children[i].new.name.last
  - Suffix: children[i].new.name.suffix
    code: |
      name_suffix()
    required: False
---
id: child birth address
question: |
  ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s birth place
fields:
  - Was ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) born in the United States?: children[i].birth_place.in_america
    datatype: yesnoradio
    default: True
  - City: children[i].birth_place.city
  - State: children[i].birth_place.state
    code: |
      states_list() 
    show if: children[i].birth_place.in_america
  - County: children[i].birth_place.county
    show if: children[i].birth_place.in_america
  - Country: children[i].birth_place.country
    show if:
      variable: children[i].birth_place.in_america
      is: False
---
id: child address
question: |
  What is ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s address?
subquestion: |
  **This address will appear on your court forms.**
  
  You need to put an address on the court forms where you can receive information about the case. It does not have to be the address where the child lives.
fields:
  - Street address: children[i].address.address
    address autocomplete: True
  - Address line 2: children[i].address.unit
    required: False
  - City: children[i].address.city
  - State: children[i].address.state
    code: |
      states_list() 
  - ZIP code: children[i].address.zip
---
id: have other parent
question: |
  Does ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) have another parent?
subquestion: |
  If ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) has another known biological parent or parent listed on the birth certificate other than you, you should click **Yes** unless they have died.
  
  If ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) only has guardians or custodians, you should click **No**. The program will ask about guardians and custodians later.
field: children[i].other_parent_status
choices:
  - Yes: has_other_parent
  - No: no_other_parent
  - Their other parent has died.: deceased_parent
#This question is a post-release addition; the name change forms now have a checkbox to track whether the other parent has passed away. With this addition, I have added this question instead of including an option in the other parent name page to note a child does not have another "main" parent. Rather than taking the diligent path of rewriting all the program's references to x.no_main_parent with references to x.other_parent_status, I am taking the efficient path of setting the x.no_main_parent variable in this question's validation code. If you are reading this because my choice has led to a mess of spaghetti code, you may curse my name.
validation code: |
  if children[i].other_parent_status == "has_other_parent":
    children[i].no_main_parent = False
  else:
    children[i].no_main_parent = True
---
id: deceased info
continue button field: children[i].deceased_info
question: |
  About ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s deceased parent
subquestion: |
  You may need to prove to the court that ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s other parent has passed away. Be prepared to present a copy of their death certificate to the judge.
---
id: main other parent
question: |
  What is the name of ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s other parent?
fields:
  - First: children[i].main_other_parent.name.first
  - Middle: children[i].main_other_parent.name.middle  
    required: False 
  - Last: children[i].main_other_parent.name.last
  - Suffix: children[i].main_other_parent.name.suffix
    code: |
      name_suffix()
    required: False 
#  - ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) does not have another parent.: children[i].no_main_parent
#    datatype: yesnowide
#validation code: |
#  if ((not showifdef('children[i].main_other_parent.name.first') or not showifdef('children[i].main_other_parent.name.last')) and \
#      (children[i].no_main_parent== False)):
#    validation_error(word("If there is not another parent, you need to click this box."), field="children[i].no_main_parent")
---
id: any other parents
question: |
  % if children[i].no_main_parent == False:
  Does ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) have any parents, guardians, or custodians other than you and ${children[i].main_other_parent}?
  % else:
  Does ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) have any guardians or custodians other than you?
  % endif
subquestion: |
  Anyone who has custody over ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) is their custodian.
fields:
  - no label: children[i].any_other_parents
    datatype: yesnoradio
---
id: about other parents guardians
continue button field: about_other_parentals
question: |
  Notifying other parents, guardians, and custodians
subquestion: |
  If your child's other parents, guardians, and custodians agree to your child's name change, they will need to sign the name change request.

  If any of them do not agree to the name change, you will need to notify them of the name change request. However, you may ask the court to not require you to notify them. Courts usually do not require notification if it could risk hardship for the child.
---
#id: child other parent
#question: |
#  Does ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) have a biological or adoptive parent other than you?
#fields:
#  - no label: children[i].include_other_parent
#    datatype: yesnoradio
#---
#id: child third parent guardian
#question: |
#  % if children[i].include_other_parent == True:
#  Does ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) have a parent or guardian other than you and ${children[i].parents[0].name.full(middle='full')}?
#  % else:
#  Does ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) have a guardian other than you? 
#  % endif
#fields:
#  - no label: children[i].include_third_parent_guardian
#    datatype: yesnoradio
---
id: child custody haver
question: |
  % if children[i].include_other_parent == False and children[i].include_third_parent_guardian == False:
  Does anyone other than you have physical custody over ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})?
  % else:
  Does anyone else have physical custody over ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})?
  % endif
fields:
  - no label: children[i].include_custody_haver
    datatype: yesnoradio
---
id: parent name
question: |
  % if j == 0:
  What is the first other parent, guardian, or custodian's name?
  % else:
  What is the additional parent, guardian, or custodian's name?
  % endif
fields:
  - First: children[i].parents[j].name.first
  - Middle: children[i].parents[j].name.middle
    required: False
  - Last: children[i].parents[j].name.last
  - Suffix: children[i].parents[j].name.suffix
    code: |
      name_suffix()
    required: False 
---
id: parent type
question: |
  Is ${children[i].parents[j].name.full(middle='full')} a parent, guardian, or custodian?
field: children[i].parents[j].parent_type
choices:
  - Parent
  - Guardian
  - Custodian
---
id: user terminated rights kickout
event: user_terminated_rights_kickout
question: |
  Sorry
subquestion: |
  You cannot request a name change for a child you do not have parental rights over.
  
  Click **Back** if you made a mistake. Or you can talk with a lawyer to discuss your options. Use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
buttons:
  - Exit: exit
  - Restart: restart
---
id: user parental rights terminated
question: |
  Were your parental rights over ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) terminated by a court order?
fields:
  - no label: children[i].no_parental_rights
    datatype: yesnoradio
---
generic object: ALIndividual
id: other parental rights terminated
question: |
  Were ${x.name.full(middle='full')}'s parental rights terminated by a court order?
subquestion: |
  Only a court can terminate someone's parental rights. If a court has not done so, you should click **No** even if ${x.name.full(middle='full')} does not do any childcare.
fields:
  - no label: x.rights_terminated
    datatype: yesnoradio
---
#I had to make a duplicate of this question for the main_other_parent object because this question pulls up a specific child name.
id: parents list parent agree
question: |
  Does ${children[i].parents[j].name.full(middle='full')} agree to ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s name change?
subquestion: |
  If ${children[i].parents[j].name.full(middle='full')} agrees to the name change, they will need to sign the name change request.
  
  If ${children[i].parents[j].name.full(middle='full')} cannot sign the name change request, you should select **No** here.
  
  If you are not certain whether ${children[i].parents[j].name.full(middle='full')} would agree to the name change, you may want to ask them before making the name change request forms.
fields:
  - no label: children[i].parents[j].agree
    datatype: yesnomaybe
---    
id: main other parent agree
question: |
  Does ${children[i].main_other_parent.name.full(middle='full')} agree to ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s name change?
subquestion: |
  If ${children[i].main_other_parent.name.full(middle='full')} agrees to the name change, they will need to sign the name change request.
  
  If ${children[i].main_other_parent.name.full(middle='full')} cannot sign the name change request, you should select **No** here.
  
  If you are not certain whether ${children[i].main_other_parent.name.full(middle='full')} would agree to the name change, you may want to ask them before making the name change request forms.
fields:
  - no label: children[i].main_other_parent.agree
    datatype: yesnomaybe
---
template: dead_agree
subject: |
  **What if they have died?**
content : |
  If the child's other parent has died, you may select **I don't know.**
  
  You might need to show the judge a copy of the other parent's death certificate as proof the other parent has died.
---
id: other parent notarized signature
continue button field: notarized_signature
question: |
  About other signatures
subquestion: |
  Any other parents, guardians, or custodians who agree to the name change will need to sign the *Request for Name Change – Child Information* form in front of a Notary Public.
  
  You can find a Notary Public at a bank or currency exchange, and in some libraries.

  There may be a small fee for getting your forms notarized.
  
  To learn more, read ILAO's article, [**What is a notary?**](https://www.illinoislegalaid.org/legal-information/what-notary)
---
generic object: ALIndividual
id: other parent address known
question: |
  Do you know ${x.name.full(middle='full')}'s address?
fields:
  - no label: x.address_known
    datatype: yesnoradio
---
generic object: ALIndividual
id: other parent address
question: |
  What is ${x.name.full(middle='full')}'s address?
fields:
  - Street address: x.address.address
    address autocomplete: True
  - Address line 2: x.address.unit
    required: False
  - City: x.address.city
  - State: x.address.state
    code: |
      states_list() 
  - ZIP code: x.address.zip
---
id: notice waiver info
continue button field:  notice_waiver_info  
question: |
  About notice and waiver
subquestion: |
  When you change a child's name, you are usually required to notify any other parent, guardian, or custodian. You provide "notice" by giving them a copy of the name change request forms. If you do not know where they live, you can publish "notice" of the name change request in a newspaper.

  You can ask the court to waive (skip) this notice if you believe that notice or publication would put your child at risk of physical harm or discrimination.
---
#I had to make a duplicate of this question for the other_main_parent object since this question pulls the specific child's name.
id: other parent risk check
question: |
   Are you worried that giving notice of the name change request to ${children[i].parents[j].name.full(middle='full')} would put ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) at risk of physical harm or discrimination?
subquestion: |
  ${collapse_template(notice_explainer)}
fields:
  - no label: children[i].parents[j].risk_check
    datatype: yesnoradio
---
id: other parent risk check
question: |
   Are you worried that giving notice of the name change request to ${children[i].main_other_parent.name.full(middle='full')} would put ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) at risk of physical harm or discrimination?
subquestion: |
  ${collapse_template(notice_explainer)}
fields:
  - no label: children[i].main_other_parent.risk_check
    datatype: yesnoradio
---
template: notice_explainer
subject: |
  **What is "giving notice?"**
content: |
  Notice is the way you tell other parents and guardians about the name change and court dates.
  
  This program can make *Notice of Court Date* forms. You can give this form to other parents and guardians by certified mail or by asking the sheriff to deliver a copy. 
  
  If you do not know a parent or guardian's address, you can notify them by newspaper. This program can make a *Publication Notice of Court Date* form.
---
sets:
  - children[i].skip
reconsider: True
code: |
  for child in children:
    if child.age_in_years() >= 18:
      child.skip = True
    elif child.user_relationship == "other":
      child.skip = True
    elif child.age_in_years(decimals=True) >= 0.5 and not child.six_months_in_illinois:
      child.skip = True
    elif child.user_relationship == "bio" or child.user_relationship == "adopt":
      if child.no_parental_rights == True:
        child.skip = True
      else:
        child.skip = False
    else:
      child.skip = False
  check_for_skips = True
---
id: debug screen
continue button field: children[i].new_debug_screen
question: |
  Debug screen
subquestion: |
  Notice list index tracker: ${notice_list_index_tracker}
  
  Parent list generator number gathered: ${parent_list_generator.number_gathered()}
  
  ${children[i].name.full(middle='full')}
  
  name list: comma_and_list(parent_list_generator)}
  
  Do these names not match? 
  
  * Parent list generator name: parent_list_generator[notice_list_index_tracker].name.full(middle='full')
  * Main other parent name: child.main_other_parent.name.full(middle='full')
---
id: more debug
continue button field: more_debug
question: |
  more debug!
subquestion: |
 how many parents in p_l_g? ${parent_list_generator.number_gathered()}
 
 % if parent_list_generator.number_gathered() > 0:
 Whose listed? ${comma_and_list(parent_list_generator)}
 % else:
 Empty list
 % endif
 
 First in index? ${parent_list_generator[0].name.full(middle='full')}
---
id: third debug
continue button field: third_debug
question: |
  Third debug
subquestion: |
  how many parents in p_l_g? ${parent_list_generator.number_gathered()}
---
generic object: ALIndividual
continue button field: x.guardian_debug
id: guardian debug
question: |
  guardian debug
---
#This code block handles logic for generating the text of the waiver reason question
#depends on:
#  - children[i].any_other_parents
#  - children[i].name.first
#  - children[i].name.middle
#  - children[i].name.last
#  - children[i].name.suffix
#  - children[i].name.new.first
#  - children[i].name.new.middle
#  - children[i].name.new.last
#  - children[i].name.suffix
#  - children[i].parents[j].agree
#  - children[i].parents[j].risk_check
#  - children[i].parents[j].address_known
#  - children[i].parents[j].name.first
#  - children[i].parents[j].name.middle
#  - children[i].parents[j].name.last
#  - children[i].parents[j].name.suffix
#  - children[i].parents[j].rights_terminated
#  - children[i].no_main_parent
#  - children[i].main_other_parent.agree
#  - children[i].main_other_parent.risk_check
#  - children[i].main_other_parent.address_known
#  - children[i].main_other_parent.name.first
#  - children[i].main_other_parent.name.middle
#  - children[i].main_other_parent.name.last
#  - children[i].main_other_parent.name.suffix
#  - children[i].main_other_parent.rights_terminated
reconsider: True
code: |
  #Parent list generator is used to gather the information of parents who the user must notify. This list is generated because just iterating through all known parents would include empty objects and parents who do not need to be notified.
  
  parent_list_generator.clear()
  parent_list_generator.there_is_another = False 
  #The parent count variable is used with parent list generator. It is used as the index variable and is incremented whenever a parent is added to the list.
  parent_count = 0
  
  #The following variables are used as flags. 
  #child_notice_would_be_published should be set to True if two conditions are met. 1. A parent does not agree to the name change (or their agrement is unknown) 2. The user does not know their address.
  #any_risk tracks should be True if there is at least one parent who does not agree to the name change and may pose a risk to the child.
  # any_to_notify should be True if there is at least one parent who does not agree to the name change and does not pose a risk to the child.
  child_notice_would_be_published = False
  any_risk = False
  any_to_notify = False
  any_pubish_waiver_requested = False
  #In addition to setting the above flags to True if necessary, this for loop also generates the parent_list_generator object.
  for child in children:
    child.child_notice_would_be_published = False
    child.any_risk = False
    child.any_to_notify = False
    if not child.skip:
    
    #The code for the main_other_parent object should match the code in the for loop for the parents list.  
      if use_safe_address:
        if not child.use_safe_address:
          child.address.address
      else:
        child.address.address
      if child.no_main_parent == False:
        if child.main_other_parent.rights_terminated == False:
          if child.main_other_parent.address_known == True:
            child.main_other_parent.address.address
          if child.main_other_parent.agree != True:
            #The following line is just included to ensure the notice waiver info block is triggered if parent.agree is set to not true via review screen.
            notice_waiver_info  
            if child.main_other_parent.address_known == False:
              child.child_notice_would_be_published = True
              child_notice_would_be_published = True
            #The following elif statement just ensures that receive_method is defined. It shouldn't do anything on the initial pass of this code block, but it should trigger the receive method question if a user edits a parent's information post-gathering and the new information means receive method must be asked.
            elif child.main_other_parent.risk_check == False:
              
              child.main_other_parent.receive_method 
            
            if child.main_other_parent.risk_check == True:
              
              any_risk = True
              child.any_risk = True
            else:
              if child.main_other_parent.address_known == True:
                child.main_other_parent.address.address
                any_to_notify = True
                child.any_to_notify = True
                already_included = False
                if parent_list_generator.number_gathered() > 0:                  
                  for item in parent_list_generator:
                    if child.main_other_parent.name.full(middle='full') == item.name.full(middle='full'):
                      if child.main_other_parent.address.on_one_line(bare=True) == item.address.on_one_line(bare=True):
                          already_included = True                      
                if already_included == False:
                  if not child.any_risk and not showifdef('child.child_notice_would_be_published') and not showifdef('child.request_waiver'):
                    parent_list_generator.append(child.main_other_parent)
          else:  
             notarized_signature
      
      if child.any_other_parents == True:
        if child.parents.number_gathered() > 0:
          for parent in child.parents:
            #The following if statement is just included to ensure the parent address block is triggered if parent.address_known is set to true via review screen.
            if parent.parent_type != "Parent" or parent.rights_terminated == False:
              if parent.address_known == True:
                parent.address.address
              if parent.agree != True:
                #The following line is just included to ensure the notice waiver info block is triggered if parent.agree is set to not true via review screen.
                notice_waiver_info  
                if parent.address_known == False:
                  child_notice_would_be_published = True
                  child.child_notice_would_be_published = True
                #The following elif statement just ensures that receive_method is defined. It shouldn't do anything on the initial pass of this code block, but it should trigger the receive method question if a user edits a parent's information post-gathering and the new information means receive method must be asked.
                elif parent.risk_check == False:
                  
                  parent.receive_method 
                
                if parent.risk_check == True:
                  any_risk = True
                  child.any_risk = True
                else:
                  if parent.address_known == True:
                    any_to_notify = True
                    already_included = False
                    if parent_list_generator.number_gathered() > 0:                  
                      for item in parent_list_generator:
                        if parent.name.full(middle='full') == item.name.full(middle='full'):
                          if parent.address.on_one_line(bare=True) == item.address.on_one_line(bare=True):
                              already_included = True                      
                    if already_included == False:
                      if not child.any_risk and not showifdef('child.child_notice_would_be_published') and not showifdef('child.request_waiver'):
                        parent_list_generator.append(parent)
              else:  
                 notarized_signature
    if child.any_risk or (child.child_notice_would_be_published == True and child.request_waiver == True):
      if showifdef('child.request_waiver'):
        child.any_risk = True
      child.note_about_waiver
      if child.waiver_reason['order'] == True:
        if child.protective_order.any_true():
          child.order_against_parents
          child.orders.gather()        
      child.hardship_text
    
    parent_list_generator.there_is_another = False 
 
  #The following block generates a list of which children would need to be included in a publication notice. 
  published_children.clear()
  published_children.there_is_another = False
  include_publication_notice = False
  if child_notice_would_be_published == True:
    for child in children:
      child.safe_publish = True
      child.need_publish = False
      if not child.skip:
        
        if child.no_main_parent == False and child.main_other_parent.rights_terminated == False:
          if child.main_other_parent.address_known == False and child.main_other_parent.agree != True and child.main_other_parent.risk_check != True:
            child.need_publish = True
          elif child.main_other_parent.agree != True and child.main_other_parent.risk_check == True:
            child.safe_publish = False
        if child.any_other_parents == True:
          child_publish_parent_index = 0
          while child_publish_parent_index < child.parents.number_gathered():
            if child.parents[child_publish_parent_index].parent_type != "Parent" or child.parents[child_publish_parent_index].rights_terminated == False:
              if child.parents[child_publish_parent_index].address_known == False and child.parents[child_publish_parent_index].agree != True and child.parents[child_publish_parent_index].risk_check != True:
                child.need_publish = True
              elif child.parents[child_publish_parent_index].agree != True and child.parents[child_publish_parent_index].risk_check == True:
                child.safe_publish = False
            child_publish_parent_index += 1
        if child.safe_publish == True and child.need_publish == True:
          if not child.any_risk and not showifdef('child.request_waiver'):
            published_children.append(child)
            include_publication_notice = True
        elif child.need_publish:
            any_pubish_waiver_requested = True
  published_children.there_is_another = False
  
  #This code block removes any parents in the list of parents to notify attached to children for whom the user wants to waive notice for another parent. It would make more sense to have not included them in the first place, but this is a change added after publication so adding this popping approach, while less efficient, requires less detangling of the code.
  if parent_list_generator.number_gathered() > 0:
    
    for child in children:
      
      if child.any_risk or showifdef('child.request_waiver') == True:
        
        notice_list_index_tracker = 0
        
        while (notice_list_index_tracker < parent_list_generator.number_gathered()) and (parent_list_generator.number_gathered() > 0):
          
          popped_main_parent = False
          any_popped_in_parents_list = False
          if parent_list_generator.number_gathered() > 0:
            
            #if notice_list_index_tracker == 1:
              #child.new_debug_screen
            
            if child.no_main_parent == False:  
              if defined('parent_list_generator[notice_list_index_tracker].name.first'):
                if parent_list_generator[notice_list_index_tracker].name.full(middle='full') == child.main_other_parent.name.full(middle='full'):
                  parent_list_generator.pop(notice_list_index_tracker)
                  #third_debug
                  popped_main_parent = True
            if not popped_main_parent:  
              
              if child.any_other_parents == True and parent_list_generator.number_gathered() > 0:
                #child.new_debug_screen
                for childs_parent in child.parents:
                  if defined('parent_list_generator[notice_list_index_tracker].name.first'):
                    if parent_list_generator[notice_list_index_tracker].name.full(middle='full') == childs_parent.name.full(middle='full'):
                      #childs_parent.guardian_debug
                      parent_list_generator.pop(notice_list_index_tracker)
                      any_popped_in_parents_list = True
          if not any_popped_in_parents_list and not popped_main_parent:
            notice_list_index_tracker += 1
            
            #child.new_debug_screen
          
  
  waiver_reason_logic = True
---
reconsider: True
code: |
  any_under_six_months = False
  for child in children:
    if not child.skip:
      if child.age_in_years(decimals=True) < 0.5:
        any_under_six_months = True
      if child.no_main_parent == False:
        child.include_parents_zero_on_child_sheet = False
        if child.main_other_parent.rights_terminated == False:
          child.include_main_parent_on_child_sheet = True
        else:
          child.include_main_parent_on_child_sheet = False
      else:
        child.include_main_parent_on_child_sheet = False
        if child.any_other_parents == True:
          if child.parents[0].parent_type == "Parent":
            if child.parents[0].rights_terminated == False and child.other_parent_status != "deceased_parent":
              child.include_parents_zero_on_child_sheet = True
            else:
              child.include_parents_zero_on_child_sheet = False
          else:
            child.include_parents_zero_on_child_sheet = False
        else:
          child.include_parents_zero_on_child_sheet = False
  parent_on_child_sheet_logic = True
---
reconsider: True
code: |
  for child in children:
    if child.any_other_parents:
      for parent in child.parents:
        parent.publication_needer = False
        if parent.address_known == False and parent.agree != True and parent.risk_check != True and showifdef('child.request_waiver') != True:
          parent.publication_needer = True
  template_variable_logic = True
---
id: want to publish check
question: |
  Are you concerned publishing notice of ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s name change would put them at risk of harm or discrimination?
subquestion: |
  Since you do not know the address of all parents, guardians, or custodians you would need to notify of this name change, you may have to publish notice in a local newspaper. However, you can file a motion requesting you not be required to publish notice.
  
  You can ask the judge to skip publication of the name change if it would be a hardship for your child.
  
  You can also ask the judge to skip publication if you have or did have a protective court order. This could be:
  
  * An Order of Protection,
  * A Stalking No Contact Order,
  * A Civil No Contact Order,
  * A protective order in someone else's criminal case,
  * Protection under someone else's bail conditions, or
  * A similar protective order outside Illinois.
fields:
  - no label: children[i].request_waiver
    datatype: yesnoradio
---
id: note about waiver
continue button field: children[i].note_about_waiver
question: |
  About waiving notice
subquestion: |
  % if children[i].child_notice_would_be_published == True:
  % if children[i].any_risk == False:
  Based on your answers, you are concerned that publishing notice of ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s name change request could put them at risk.
  % else:
  Based on your answers, you are concerned that publishing notice of ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s name change request could put them at risk. 
  
  You are also concerned that notifying their parents, guardians, and custodians could put them at risk.
  % endif
  % else:
  Based on your answers, you are concerned that notifying ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s parents, guardians, and custodians of their name change request could put them at risk.
  % endif
  
  This program can make a *Motion to Waive Notice and Publication* for ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s name change. The judge may decide not to grant the motion. Judges often require all of a child's parents to be notified of a name change.
  
  If you do not want to give notice, you may want a lawyer to help you. Use [**Get Legal Help**](https://www.illinoislegalaid.org/get-legal-help) to find free or low-cost legal services in your area.
---
id: waiver reasons
question: |
  Why do you need a notice waiver for ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})?
subquestion: |
  You may need a waiver if you have or did have protection from a court order. You may also need a waiver if publication would be a hardship for ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}).
  
  A protective court order can include:
  
  * An Order of Protection,
  * A Stalking No Contact Order,
  * A Civil No Contact Order,
  * A protective order in someone else's criminal case,
  * Protection under someone else's bail conditions, or
  * A similar protective order outside Illinois.
  
  A hardship can be many things. It can include fear of:
  
  * Physical violence,
  * Discrimination,
  * Harassment,
  * Bullying, or
  * Threats of violence.
fields:
  - no label: children[i].waiver_reason
    datatype: checkboxes
    minlength: 1
    choices:
      - I have or did have protection from a court order.: order
      - I need a waiver of notice and publication of name change because it would be a hardship for the person who is changing their name.: hardship
    validation messages:
      minlength: |
        Please select at least one or click < Back if none apply.
---
id: protective order type
question: |
  What kind of court protection do or did you have?
subquestion: |
  You can enter details about the order on another screen.

  If you do not have or did not have any of these kinds of orders, you can click **Back** and change your answer.
fields:
  - I have or did have protection from: children[i].protective_order
    datatype: checkboxes
    minlength: 1
    none of the above: False
    choices:
      - An Order of Protection: op
      - A Stalking No Contact Order: snco
      - A Civil No Contact Order: cnco
      - A Protective order in someone else's criminal case: other_criminal
      - Being a protected person under someone else's bail conditions: bail
      - A similar protective order outside Illinois: other_order
    validation messages:
      minlength: |
        Please select at least one or click < Back if none apply.
  - In which state was the protective order? (not Illinois): children[i].other_order_state
    maxlength: 25
    show if:
      variable: children[i].protective_order['other_order']
      is: True
---
# add question if protective order is against one of the other parents
id: order against parents
question: |
  Is the protective order against one of ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s parents?
subquestion: |
  Click **Yes** if the abuser in the protective order is the parent, guardian, or custodian of ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}).
fields:
  - no label: children[i].order_against_parents
    datatype: yesnoradio
---
code: |
  children[i].orders[j].name.text
  if children[i].orders.number_gathered() >= 4:
    children[i].orders.there_is_another = False
  children[i].orders[j].complete = True
---
id: protective order details
question: |
  % if j == 0:
  Protective order case details
  % else:
  ${capitalize(ordinal(j))} protective order case details
  % endif
subquestion: |
  For your *Motion to Waive Notice and Publication*, enter more information about protective orders.
  
  You said you have or did have: 
  
  % if children[i].protective_order['op']:
   * An Order of Protection
  % endif
  % if children[i].protective_order['snco']:
   * A Stalking No Contact Order
  % endif
  % if children[i].protective_order['cnco']:
   * A Civil No Contact Order
  % endif
  % if children[i].protective_order['other_criminal']:
   * A Protective order in someone else's criminal case
  % endif
  % if children[i].protective_order['bail']:
   * Being a protected person under someone else's bail conditions
  % endif
  % if children[i].protective_order['other_order']:
   * A similar protective order outside Illinois
  % endif
  
  Enter information about one case at a time. You can enter other cases on another screen.
fields:
  - Case number: children[i].orders[j].number
    maxlength: 30
  - County: children[i].orders[j].name.text
    maxlength: 30
  - State: children[i].orders[j].state
    code: |
      states_list()
    default: IL      
---
id: any other orders
question: |
  Are there other protective order cases?
subquestion: |
  To waive notice and publication in the name change request, you must add details about the following cases:
  
  % if children[i].protective_order['op']:
   * An Order of Protection
  % endif
  % if children[i].protective_order['snco']:
   * A Stalking No Contact Order
  % endif
  % if children[i].protective_order['cnco']:
   * A Civil No Contact Order
  % endif
  % if children[i].protective_order['other_criminal']:
   * A Protective order in someone else's criminal case
  % endif
  % if children[i].protective_order['bail']:
   * Being a protected person under someone else's bail conditions
  % endif
  % if children[i].protective_order['other_order']:
   * A similar protective order outside Illinois
  % endif
  
  You can enter up to 4 cases. So far you have told us about:
  
  % for order in children[i].orders:
   * Case number: ${order.number} in ${order.name.text}, ${order.state}
  % endfor
fields:
  - "Add another case?": children[i].orders.there_is_another
    datatype: yesnoradio
---
id: hardship reason
question: |
  % if children[i].child_notice_would_be_published == True:
  Explain why publication and giving notice would be a hardship for ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})
  % else:
  Explain why giving notice would be a hardship for ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})
  % endif
subquestion: |
  ${collapse_template(notice_waiver_example)}
fields:
  - Notice and publication would be a hardship because:: children[i].hardship_text
    input type: area
    rows: 12
    maxlength: 500
---
template: notice_waiver_example
subject: |
  **What should my answer look like?**
content: |  
  This explanation will go on your *Motion to Waive Notice and Publication*. You should explain why giving or publishing notice would put ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) at risk of physical harm or discrimination.

  Here are some examples: 
  
  "I need to change my child's name to 'New Name' because we are trying to get away from my ex-boyfriend. He has abused my child in the past. I am afraid he will hurt my child if he learns about this name change request."
  
  "My child wants to change their name to 'New Name' as part of a gender transition. I am afraid publishing notice of this change in the newspaper could lead to my child and I experiencing discrimination or targeted harassment."
---
generic object: ALIndividual
id: other parent notice method
question: |
  How will you give ${x.name.full(middle='full')} notice of this name change request?
subquestion: |
  You can give notice by certified mail or by asking the sheriff to deliver a copy of the forms to the other parents or custodian. You can only notify them by newspaper if you do not know their address.
field: x.receive_method 
choices:
  - I will give notice of this name change and the scheduled court date by certified mail.: mail
  - I will give notice of this name change and the scheduled court date by service of process by sheriff.: sheriff
---
id: published notice info
continue button field: published_notice_info 
question: |
  About published notice
subquestion: |
  You said you don't know the address of a parent, guardian, or custodian who needs to be notified of the name change.
  
  If any of your children's parents, guardians, or custodians cannot be found, you must ask a local newspaper to publish notice of the name change request once a week for three weeks in a row.

  This program will make a *Publication Notice of Court Date.* You must file it with the Circuit Clerk before you publish the notice in a newspaper.

  Ask the Circuit Clerk for a court date at least 8 weeks from when you file the Publication Notice.
---
id: child safety address
question: |
  Do you want to use the safe mailing address for ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})?
subquestion: |
  You need to put an address on the court forms where you can receive information about the case. It does not have to be the address where the child lives.
  
  The safe mailing address you entered is:
  
  ${users[0].address.line_one(bare=True)}
  ${users[0].address.line_two()}
fields:
  - no label: children[i].use_safe_address
    datatype: yesnoradio
---
id: your contact information
generic object: ALIndividual
question: |
  What is your contact information?
subquestion: |
  The court or other parties might need to contact you about this case.

  **This information will appear on your court forms.**
  
  If you do not want to list a phone number on your forms, leave it blank.

  If you have an email address, you must list it. Be sure to check your email daily, otherwise you may miss important information about your case.

  ${ collapse_template(contact_info_help) }  
fields:  
  - Phone number: x.phone_number
    datatype: al_international_phone
    required: False
  - label: |
      Do you have an email address?
    field: x.has_email_address      
    datatype: yesnoradio
  - note: |
      This email address will appear on your court forms. Be sure to check 
      this email daily, otherwise you may miss important information about 
      your case.
    show if: x.has_email_address      
  - Email address: x.email    
    datatype: email
    show if: 
      variable: x.has_email_address
      is: True
---
template: contact_info_help
subject: |
  **What if I don't want to list my email address?**
content: |  
  If you do not want to enter your personal email address, you can create a new email account to get email about your case.
  
  To make a new email account try one of these email services:
  
  * [**Gmail**](https://accounts.google.com/SignUp)
  * [**Outlook**](https://outlook.live.com/owa/?nlp=1&signup=1)
  * [**Yahoo**](https://login.yahoo.com/account/create?.lang=en-US&.intl=us)
---
id: filing county
question: |
  Which county are you filing the name change request in?
fields:
  - no label: trial_court_index
    datatype: integer
    code: |
      ilao_court_county_lookup(court_list)
validation code: |
  if trial_court_index == "-1":
    trial_court = court_list.as_court('trial_court', 15)
  else:
    trial_court = court_list.as_court('trial_court', trial_court_index)
---
code: |
  trial_court_index
  filing_county = trial_court.address.county
---
depends on:
  - trial_court_index
  - cook_district
code: |
  if trial_court_index == -1:
    #I commented out the line normally used in this sort of code block and manually put in 15 instead. This sets the trial_court object to the Daley Center for any user filing in Cook County. Why did I do this? Because the courthouse address is not used in this program, this code block is only being used due to our standardization of the county blocks. If you need to reintroduce courthouse addresses in an update, reimplement the "trial_court = court_list.as_court('trial_court', cook_district)" line. You'll also want to reactivate the corresponding review screen buttons.
    #trial_court = court_list.as_court('trial_court', cook_district)
    trial_court = court_list.as_court('trial_court', 15)
  else:
    trial_court = court_list.as_court('trial_court', trial_court_index)
    
  court_name = str(trial_court.name)
  court_street_address = str(trial_court.address.address)
  court_city = str(trial_court.address.city)
  court_state = str(trial_court.address.state)
  court_zip = str(trial_court.address.zip)
  filing_county = str(trial_court.address.county)
  courthouse_info = court_name + ", " + court_street_address + ", " + court_city + ", " + court_state + " " + court_zip
---
id: Cook County district
question: |
  In which Cook County courthouse is your case?
subquestion: |
  This information should be found near the top of your court papers.

  ${ collapse_template(cook_district_help) }  
field: cook_district
choices:
  - First Municipal District, Daley Center, 50 W. Washington Street, Chicago: 15
  - Second Municipal District, 5600 Old Orchard Road, Skokie: 16
  - Third Municipal District, 2121 Euclid Avenue, Rolling Meadows: 17
  - Fourth Municipal District, 1500 Maybrook Drive, Maywood: 18
  - Fifth Municipal District, 10220 S. 76th Avenue, Bridgeview: 19
  - Sixth Municipal District, 16501 South Kedzie Parkway, Markham: 20
---
template: cook_district_help
subject: |
  **What if I am not sure?**
content: |  
  Visit **[Illinois Court Help](https://www.ilcourthelp.gov/)**, or you can call or text (833) 411-1121 for assistance.
---
template: signature_help
subject: |
  **What does it mean to sign the *Request for Name Change*?**
content: |  
  By signing your *Request for Name Change*, you are certifying that:
  
  * Everything on the form is true and correct, and
  * You understand that making a false statement on the form is perjury, which can result in criminal penalties.
  
  See the [**Code of Civil Procedure, 735 ILCS 5/1-109**](https://www.ilga.gov/legislation/ilcs/documents/073500050k1-109.htm), for more information.
---
id: notice reminder
continue button field: notice_reminder
question: |
  % if parent_list_generator.number_gathered() > 3:
  About the *Notice of Court Date* forms
  % else:
  About the *Notice of Court Date*
  % endif
subquestion: |  
  % if parent_list_generator.number_gathered() > 3:
  Each notice form can include up to 3 people. Be sure to send a copy to **each person** on each notice.
  % else:
  The notice form can include up to 3 people. Be sure to send a copy to **each person** on the notice.
  % endif
---
id: complete publication notice
continue button field: complete_notice
question: |
  % if child_notice_would_be_published == True and any_risk == False and any_to_notify == True:
  Complete your notices
  % elif child_notice_would_be_published == True and any_risk == False:
  Complete your publication notice
  % else:
  % if parent_list_generator.number_gathered() > 1:
  Complete your notices
  % else:
  Complete your notice
  % endif
  % endif
subquestion: |
  When you file the name change request, the clerk should give you details about going to court. 
  
  % if child_notice_would_be_published == True and any_risk == False and any_to_notify == True:
  Add the court hearing date, time, and how to attend court to the *Notice of Court Date* and *Publication Notice of Court Date* forms.
  
  **Note:** These sections need to be complete before you send out the notices. 
  % elif child_notice_would_be_published == True and any_risk == False:
  Add the court hearing date, time, and how to attend court to the *Publication Notice of Court Date*.
  
  **Note:** These sections need to be complete before the newspaper can publish the notice.  
  % else:
  % if parent_list_generator.number_gathered() > 1:
  Add the court hearing date, time, and how to attend court to the *Notice of Court Date* forms.
  
  **Note:** These sections need to be complete before you send out the notices. 
  % else:
  Add the court hearing date, time, and how to attend court to the *Notice of Court Date*.
  
  **Note:** These sections need to be complete before you send out the notice. 
  % endif
  % endif
  
  [FILE name_change_court_date.png, 100%, Court Date Information section of Publication notice]

  [FILE name_change_hearing_details.png, 100%, How to Attend Hearing section of Publication notice]

---
id: signature
question: |
  Do you want to add your e-signature to your forms?
subquestion: |
  This program can put "**/s/ ${users[0].name.full(middle='full')}**" where you would sign your name. The court will accept this as your signature.
  
  If you do not add your **{e-signature}** now, you must sign your forms before you file them.
  
  <div class="alert alert-info ilao-info" role="alert">
    <h6 class="alert-heading">What it means to sign your forms</h6>
    <p>By signing your <i>Small Claims Complaint</i>, you are certifying that:
  <p>
  <p><ul>
  <li>You read the document,</li>
  <li>You believe it to be true and correct, and</li>
  <li>You are not filing it for an improper purpose.</li>
  </ul><p>
  <p>See the <a href="https://www.ilga.gov/legislation/ilcs/documents/073500050k1-109.htm"><b>Code of Civil Procedure, 735 ILCS 5/1-109</b></a> for more information.</p>
  </div>
field: e_signature
choices:
  - Yes: True
  - No, I will sign my forms later.: False
terms:
  - "e-signature": |
      An e-signature is an electronic signature. It is a digital version of a signature that has the same effect as a hand-written signature.
---
id: forms assembling
continue button field: forms_assembling
question: |
  Almost done
subquestion: |
  After you click **Next**, it will take a few moments to finish making your forms.
  
  ###### You do not need to refresh your screen. Hang in there!
  
  &nbsp;
---
id: get docs screen
event: get_docs_screen
question: |
  Download
subquestion: |  
  Your forms are ready. View and download your forms below. Click **Make changes** to fix any mistakes.
  
  The Instructions have important information. You can read them to find out what to do next.
  
  This program does not file your forms with the court. You will need to do this yourself. Learn about [**e-filing in Illinois**](https://www.illinoiscourts.gov/eservices/information-for-filers-without-lawyers).
  
  ${ action_button_html(url_action('review_answers'), label=':edit: Make changes', color='success', size="md") }

  ${ al_user_bundle.download_list_html() }
 
  &nbsp;

  ${ al_user_bundle.send_button_html(show_editable_checkbox=False) }
  
  **Note:** This program **does not** file your forms. You will need to do this yourself. Learn about [**e-filing in Illinois**](https://www.illinoiscourts.gov/eservices/information-for-filers-without-lawyers).

  Thank you for using ILAO Easy Forms!
under: |
  % if not user_logged_in():
  [${fa_icon("sign-in-alt", color="#0079d0", size="sm")} **Sign-in**](${url_of('login', next=interview_url())}) or [**create**](${url_of('register', next=interview_url())}) an ILAO Easy Form account to save your progress (optional).
  % endif

 
  ${ action_button_html(interview_url(i="docassemble.ILAO:feedback.yml", easy_form_interview=ilao_easy_form_url, easy_form_title=ilao_easy_form_title, easy_form_page=user_info().question_id, easy_form_variable=user_info().variable, local=False,reset=1), label=':comment: Was this program helpful?', color="#181c36", size="md", new_window=True) }
---
generic object: ALDocumentBundle
template: x.send_email_template
subject: |
  Name change for a minor
content: |
  Your forms are attached.
  
  Thanks for using ILAO Easy Forms!
  
  [Illinois Legal Aid Online](https://www.illinoislegalaid.org)
---
objects:
  - instructions: ALDocument.using(title="Instructions", filename="instructions.pdf", has_addendum=False)
  - request: ALDocument.using(title="Request for name change (minor children)", filename="minor_name_change_request.pdf", has_addendum=False)
  - additional_children: ALDocument.using(title="Additional children", filename="additional_children.pdf", has_addendum=False)
  - publication_notice: ALDocument.using(title = "Publication notice of court date", filename="publication_notice.pdf", has_addendum=False)
  #- order_to_waive_notice: ALDocument.using(title = "Order on motion to waive notice and publication", filename="order_to_waive_notice.pdf", has_addendum=False)
  - order: ALDocument.using(title = "Order for name change (minor name change)", filename="order.pdf", has_addendum=False)
  #- motion_to_waive_notice: ALDocument.using(title = "Motion to waive notice and publication", filename="motion_to_waive.pdf", has_addendum=False)
---
objects:
  - children[i].additional_parents_bundle: ALDocumentBundle.using(elements=[], filename="additional_parent.pdf", title = "Additional parents", enabled=True)
---

---
reconsider: True
code: |
  elements_for_children_bundle = []
  elements_for_waive_bundle = []
  elements_for_waive_order_bundle = []
  
  for index, child in enumerate(children):
    child.elements_for_additional_parents_bundle = []
    child.motion_to_waive_notice.enabled = False
    child.order_to_waive_notice.enabled = False
    if not child.skip:
      for index, parent in enumerate(child.parents):
        child.elements_for_additional_parents_bundle.append(parent.parent_info_sheet)   
      child.additional_parents_bundle.elements = child.elements_for_additional_parents_bundle
      elements_for_children_bundle.append(child.single_child_bundle)
      if child.any_risk == True or (child.child_notice_would_be_published == True and showifdef('child.request_waiver') == True):
        child.motion_to_waive_notice.enabled = True
        child.order_to_waive_notice.enabled = True
        elements_for_waive_bundle.append(child.motion_to_waive_notice)
        elements_for_waive_order_bundle.append(child.order_to_waive_notice)
  organized_children_bundle.elements = elements_for_children_bundle
  motion_to_waive_bundle.elements = elements_for_waive_bundle
  order_to_waive_bundle.elements = elements_for_waive_order_bundle
  refresh_bundles = True
---
#This code block removes skipped children from the children list object. A for loop would not work well for this purpose, since each pop would change which child a given index refers to, so a clunky while loop with a integer variable is used.
reconsider: True
code: |
  iteration_tracker = 0
  included_children_count = 0
  excluded_children_count = 0
  while iteration_tracker < children.number_gathered():
    if children[iteration_tracker].skip:
      children.pop(iteration_tracker)
      excluded_children_count += 1
    else:
      iteration_tracker += 1
      included_children_count += 1
  pop_skipped_children = True
  
---
objects:
  - children[i].single_child_bundle: ALDocumentBundle.using(elements=[children[i].child_information, children[i].additional_criminal_history, children[i].additional_parents_bundle], filename="single_child_information.pdf", title = "Child information", enabled=True)
---
objects:
  - organized_children_bundle: ALDocumentBundle.using(elements=[], filename="children_information.pdf", title = "Children information", enabled=True)
---
#objects:
#  - all_criminal_addendums: ALDocumentBundle.using(elements=[item.additional_criminal_history for item in children], filename="additional_criminal_history.pdf", title = "Additional criminal history", enabled = True)
---
objects:
  - change_order_bundle: ALDocumentBundle.using(elements = [order for item in children], filename="name_change_order_bundle.pdf", title = "Order for name change (1 for each child)", has_addendum=False, enabled=True)
---
objects:
  - request_bundle: ALDocumentBundle.using(elements=[request, additional_children, organized_children_bundle], filename="name_change_request_bundle.pdf", title="Request for name change", enabled=True) 
---
objects:
  -  al_user_bundle: ALDocumentBundle.using(elements=[instructions, request_bundle, motion_to_waive_bundle, publication_notice, notice_of_date_bundle, order_to_waive_bundle, change_order_bundle], filename="name_change_child.pdf", title="All forms")
  -  al_court_bundle: ALDocumentBundle.using(elements=[instructions, request_bundle, motion_to_waive_bundle, publication_notice, notice_of_date_bundle, change_order_bundle, order_to_waive_bundle], filename="name_change_child.pdf", title="All forms")
---
code: |
  instructions.enabled = True
  request.enabled = True
  order.enabled = True
  additional_children.enabled = False
  
  
  #The name change request form has space for 4 children. Any more children must be on the additional children template.
  if children.number_gathered() > 4:
    additional_children.enabled = True

  #notices.enabled = False
  
  #For some reason the program doesn't always behave unless I set this enabled value to True outside of the for loop. 
  if children.there_are_any and children.number_gathered() > 0:
    children[0].child_information.enabled = True 
    #child_loop_index = 0 
    #while child_loop_index < children.number_gathered():
  
    for child in children:  
      child.has_custodian = False
      child.has_guardian = False
      
      child.additional_parents_bundle.enabled = False
      child.additional_criminal_history.enabled = False
      
      if child.skip:
        child.child_information.enabled = False
        child.parents[0].parent_info_sheet.enabled = False
      else:
        child.child_information.enabled = True
      
        if child.felonies or child.registry or child.id_theft:
          if child.convictions.number() > 3:
            child.additional_criminal_history.enabled = True
    
        # new logic test
          
        if child.any_other_parents == True:
          type_check_index = 0
          while type_check_index < child.parents.number_gathered():
            if child.include_parents_zero_on_child_sheet == True and type_check_index == 0:
              child.parents[type_check_index].parent_info_sheet.enabled = False
            else:
              child.parents[type_check_index].parent_info_sheet.enabled = True
              child.additional_parents_bundle.enabled = True
              if child.parents[type_check_index].parent_type == "Custodian":
                child.has_custodian = True
              else:
                child.has_guardian = True
            type_check_index += 1
        else:
          child.parents[0].parent_info_sheet.enabled = False
        
        
  #motion_to_waive_notice.enabled = False
  #order_to_waive_notice.enabled = False
  publication_notice.enabled = False
  
  #for child in children:
  #  child.motion_to_waive_notice.enabled = False
  #
  #if any_risk == True or (child_notice_would_be_published == True and showifdef('any_pubish_waiver_requested') == True):
    #for child in children:
    #  if not child.skip:
    #    if child.other_parent_status == "has_other_parent" or child.any_other_parents:
    #      if showifdef('child.any_risk') == True or (child.child_notice_would_be_published == True and showifdef('child.request_waiver') == True):
    #        child.motion_to_waive_notice.enabled = True
    #order_to_waive_notice.enabled = True
  for child in children:
    if include_publication_notice == True and showifdef('child.request_waiver') != True:
      publication_notice.enabled = True
---
attachment:
  variable name: instructions[i]
  name: instructions
  filename: instructions
  skip undefined: True
  editable: False
  pdf template file: How_To_Change_A_Name_for_Minor_Children2.pdf
  fields:
      - "fake": ${ "" }
---
attachment:
  variable name: request[i]
  name: request
  filename: request
  skip undefined: True
  editable: False
  pdf template file: Request_for_Name_Change_Minor.pdf
  fields:
    - "filing_county": ${filing_county}
    - "user_name": ${ users[0].name.full(middle='full')}
    - "case_number": ${""}
    - "one_child_old_first": ${children[0].name.first}
    - "one_child_old_middle": ${children[0].name.middle}
    - "one_child_old_last": ${children[0].name.last if children[0].name.suffix == "" else (children[0].name.last + " " + children[0].name.suffix)}
    - "one_child_new_first": ${children[0].new.name.first}
    - "one_child_new_middle": ${ children[0].new.name.middle}
    - "one_child_new_last": ${children[0].new.name.last if children[0].new.name.suffix == "" else (children[0].new.name.last + " " + children[0].new.name.suffix)}
    - "two_child_old_first": ${children[1].name.first}
    - "two_child_old_middle": ${children[1].name.middle}
    - "two_child_old_last": ${children[1].name.last if children[1].name.suffix == "" else (children[1].name.last + " " + children[1].name.suffix)}
    - "two_child_new_first": ${children[1].new.name.first}
    - "two_child_new_middle": ${ children[1].new.name.middle}
    - "two_child_new_last": ${children[1].new.name.last if children[1].new.name.suffix == "" else (children[1].new.name.last + " " + children[1].new.name.suffix)}
    - "three_child_old_first": ${children[2].name.first}
    - "three_child_old_middle": ${children[2].name.middle}
    - "three_child_old_last": ${children[2].name.last if children[2].name.suffix == "" else (children[2].name.last + " " + children[2].name.suffix)}
    - "three_child_new_first": ${children[2].new.name.first}
    - "three_child_new_middle": ${ children[2].new.name.middle}
    - "three_child_new_last": ${children[2].new.name.last if children[2].new.name.suffix == "" else (children[2].new.name.last + " " + children[2].new.name.suffix)}
    - "four_child_old_first": ${children[3].name.first}
    - "four_child_old_middle": ${children[3].name.middle}
    - "four_child_old_last": ${children[3].name.last if children[3].name.suffix == "" else (children[3].name.last + " " + children[3].name.suffix)}
    - "four_child_new_first": ${children[3].new.name.first}
    - "four_child_new_middle": ${ children[3].new.name.middle}
    - "four_child_new_last": ${children[3].new.name.last if children[3].new.name.suffix == "" else (children[3].new.name.last + " " + children[3].new.name.suffix)}
    - "more_than_four_kids": ${True if children.number_gathered() > 4 else False}
    - "child_info_attached": ${True}
    #- "illinois_start_date": ${format_date(started_living_in_illinois, format='long')}
    - "e_signature": ${ users[0].name.full(middle='full') if e_signature == True else ""}
    - "six_months": ${False if any_under_six_months else True}
    - "user_address": ${users[0].address.on_one_line(bare=True)}
    - "user_phone": ${phone_number_formatted(users[0].phone_number)}
    - "user_email": ${users[0].email if users[0].has_email_address == True else ""}
    - "user_hide_address_cb": ${ True if use_safe_address else False }
---
#Change this to a list comprehension?
attachment:
  variable name: additional_children[i]
  name: additional_children
  filename: additional_children
  skip undefined: True
  editable: False
  pdf template file: Request_for_Name_Change_Additional.pdf
  fields:
    - "case_number": ${""}
    - "filing_county": ${filing_county}
    - "user_name": ${ users[0].name.full(middle='full')}
    - "child_old_first_5": ${children[4].name.first}
    - "child_old_middle_5": ${children[4].name.middle}
    - "child_old_last_5": ${children[4].name.last if children[4].name.suffix == "" else (children[4].name.last + " " + children[4].name.suffix)}
    - "child_new_first_5": ${children[4].new.name.first}
    - "child_new_middle_5": ${children[4].new.name.middle}
    - "child_new_last_5": ${children[4].new.name.last if children[4].new.name.suffix == "" else (children[4].new.name.last + " " + children[4].new.name.suffix)}
    - "child_old_first_6": ${children[5].name.first}
    - "child_old_middle_6": ${children[5].name.middle}
    - "child_old_last_6": ${children[5].name.last if children[5].name.suffix == "" else (children[5].name.last + " " + children[5].name.suffix)}
    - "child_new_first_6": ${children[5].new.name.first}
    - "child_new_middle_6": ${children[5].new.name.middle}
    - "child_new_last_6": ${children[5].new.name.last if children[5].new.name.suffix == "" else (children[5].new.name.last + " " + children[5].new.name.suffix)}
    - "child_old_first_7": ${children[6].name.first}
    - "child_old_middle_7": ${children[6].name.middle}
    - "child_old_last_7": ${children[6].name.last if children[6].name.suffix == "" else (children[6].name.last + " " + children[6].name.suffix)}
    - "child_new_first_7": ${children[6].new.name.first}
    - "child_new_middle_7": ${children[6].new.name.middle}
    - "child_new_last_7": ${children[6].new.name.last if children[6].new.name.suffix == "" else (children[6].new.name.last + " " + children[6].new.name.suffix)}
    - "child_old_first_8": ${children[7].name.first}
    - "child_old_middle_8": ${children[7].name.middle}
    - "child_old_last_8": ${children[7].name.last if children[7].name.suffix == "" else (children[7].name.last + " " + children[7].name.suffix)}
    - "child_new_first_8": ${children[7].new.name.first}
    - "child_new_middle_8": ${children[7].new.name.middle}
    - "child_new_last_8": ${children[7].new.name.last if children[7].new.name.suffix == "" else (children[7].new.name.last + " " + children[7].new.name.suffix)}
    - "child_old_first_9": ${children[8].name.first}
    - "child_old_middle_9": ${children[8].name.middle}
    - "child_old_last_9": ${children[8].name.last if children[8].name.suffix == "" else (children[8].name.last + " " + children[8].name.suffix)}
    - "child_new_first_9": ${children[8].new.name.first}
    - "child_new_middle_9": ${children[8].new.name.middle}
    - "child_new_last_9": ${children[8].new.name.last if children[8].new.name.suffix == "" else (children[8].new.name.last + " " + children[8].new.name.suffix)}
    - "child_old_first_10": ${children[9].name.first}
    - "child_old_middle_10": ${children[9].name.middle}
    - "child_old_last_10": ${children[9].name.last if children[9].name.suffix == "" else (children[9].name.last + " " + children[9].name.suffix)}
    - "child_new_first_10": ${children[9].new.name.first}
    - "child_new_middle_10": ${children[9].new.name.middle}
    - "child_new_last_10": ${children[9].new.name.last if children[9].new.name.suffix == "" else (children[9].new.name.last + " " + children[9].new.name.suffix)}
    - "child_old_first_11": ${children[10].name.first}
    - "child_old_middle_11": ${children[10].name.middle}
    - "child_old_last_11": ${children[10].name.last if children[10].name.suffix == "" else (children[10].name.last + " " + children[10].name.suffix)}
    - "child_new_first_11": ${children[10].new.name.first}
    - "child_new_middle_11": ${children[10].new.name.middle}
    - "child_new_last_11": ${children[10].new.name.last if children[10].new.name.suffix == "" else (children[10].new.name.last + " " + children[10].new.name.suffix)}
---
generic object: ALIndividual
attachment:
  variable name: x.order_to_waive_notice[i]
  name: order_to_waive_notice
  filename: order_to_waive_notice
  skip undefined: True
  editable: False
  pdf template file: order_to_waive_notice.pdf
  fields:
    - "trial_court_county": ${filing_county}
    - "user": ${ users[0].name.full(middle="full") }
---    
generic object: ALIndividual
attachment:
  variable name: x.motion_to_waive_notice[i]
  name: motion_to_waive_notice
  filename: motion_to_waive_notice
  skip undefined: True
  editable: False
  pdf template file: motion_to_waive_notice.pdf
  fields:      
    - "trial_court_county": ${ trial_court.address.county.upper() }
    - "user__1": ${ users[0].name.full(middle="full") }
    - "waiver_order_cb": ${ True if x.waiver_reason['order'] == True else '' }
    - "protective_order_op": ${ True if x.protective_order['op'] == True else '' }
    - "protective_order_snco": ${ True if x.protective_order['snco'] == True else '' }
    - "protective_order_cnco": ${ True if x.protective_order['cnco'] == True else '' }
    - "protective_order_criminal": ${ True if x.protective_order['other_criminal'] == True else '' }
    - "protective_order_bail": ${ True if x.protective_order['bail'] == True else '' }
    - "protective_order_other": ${ True if x.protective_order['other_order'] == True else '' }
    - "protective_order_other_state": ${x.other_order_state if x.protective_order['other_order'] else '' }
    - "protective_order_minor_parent": ${ x.order_against_parents }
    - "waiver_hardship_cb": ${ True if x.waiver_reason['hardship'] == True else '' }
    - "hardship_text": ${ x.hardship_text }
    - "order_county_1": ${ x.orders[0].name.text if x.waiver_reason['order'] == True else '' }
    - "order_state_1": ${ x.orders[0].state if x.waiver_reason['order'] == True else '' }
    - "order_case_number_1": ${ x.orders[0].number if x.waiver_reason['order'] == True else '' }
    - "order_county_2": ${ x.orders[1].name.text if x.waiver_reason['order'] == True else '' }
    - "order_state_2": ${ x.orders[1].state if x.waiver_reason['order'] == True else '' }
    - "order_case_number_2": ${ x.orders[1].number if x.waiver_reason['order'] == True else '' }
    - "order_county_3": ${ x.orders[2].name.text if x.waiver_reason['order'] == True else '' }
    - "order_state_3": ${x.orders[2].state if x.waiver_reason['order'] == True else '' }
    - "order_case_number_3": ${ x.orders[2].number if x.waiver_reason['order'] == True else '' }
    - "order_county_4": ${ x.orders[3].name.text if x.waiver_reason['order'] == True else '' }
    - "order_state_4": ${ x.orders[3].state if x.waiver_reason['order'] == True else '' }
    - "order_case_number_4": ${ x.orders[3].number if x.waiver_reason['order'] == True else '' }
    - "user_signature": ${ users[0].name.full(middle="full") if e_signature else '' }
    - "user__2": ${ users[0].name.full(middle="full") }
    - "user_address": ${ users[0].address.on_one_line(bare=True) }
    - "user_hide_address_cb": ${ True if use_safe_address else '' }
    - "user_phone": ${ phone_number_formatted(users[0].phone_number) }
    - "user_atty_number": ${ '' }
    - "user_email": ${ users[0].email if users[0].has_email_address else '' }
---
#JUMP
---
generic object: ALIndividual
attachment:
  variable name: x.notice_of_court_date[i]
  name: notice_of_court_date
  filename: notice_of_court_date
  skip undefined: True
  editable: True
  pdf template file: Notice_of_Court_Date_Minor2.pdf
  fields:  
    - "filing_county": ${filing_county}
    - "user_name": ${ users[0].name.full(middle='full')}
    - "case_number": ${""}
    - "court_date": ${""}
    - "court_time": ${""}
    - "court_am": ${False}
    - "court_pm": ${False}
    - "courtroom": ${""}
    - "in_person": ${False}
    #- "courtroom_address": ${courthouse_info}
    - "remote": ${False}
    - "video_website": ${""}
    - "video_log_in": ${""}
    - "call_in_number": ${""}
    - "clerk_phone": ${""}
    - "clerk_website": ${""}
    - "other_parent_name": ${x.name.full(middle='full')}
    - "other_parent_address": ${x.address.on_one_line(bare=True) if x.address_known == True else ""}
    - "by_mail_1": ${True if x.receive_method == "mail" else False}
    - "by_sheriff_1": ${True if x.receive_method == "sheriff" else False}
    - "other_parent_notice_date": ${""}
    - "guardian_name": ${x.second_person.name.full(middle='full')}
    - "guardian_address": ${x.second_person.address.on_one_line(bare=True) if x.second_person.address_known == True else ""}
    - "by_mail_2": ${True if x.second_person.receive_method == "mail" else False}
    - "by_sheriff_2": ${True if x.second_person.receive_method == "sheriff" else False}
    - "guardian_notice_date": ${""}
    - "custodian_name": ${x.third_person.name.full(middle='full')}
    - "custodian_address": ${x.third_person.address.on_one_line(bare=True) if x.third_person.address_known == True else ""}
    - "by_mail_3": ${True if x.third_person.receive_method == "mail" else False}
    - "by_sheriff_3": ${True if x.third_person.receive_method == "sheriff" else False}
    - "custodian_notice_date": ${""}
    - "e_signature": ${ users[0].name.full(middle='full') if e_signature == True else ""}
    - "user_address": ${users[0].address.on_one_line(bare=True)}
    - "alternate_address": ${use_safe_address}
    - "user_phone": ${phone_number_formatted(users[0].phone_number)}
    - "user_email": ${users[0].email if users[0].has_email_address == True else ""}
---
attachment:
  variable name: order[i]
  name: order
  filename: order
  skip undefined: True
  editable: False
  pdf template file: Order_for_Name_Change_Minor.pdf
  fields:  
    - "filing_county": ${filing_county}
    - "user_name": ${ users[0].name.full(middle='full')}
    - "case_number": ${""}
---
attachment:
  variable name: publication_notice[i]
  name: publication_notice
  filename: publication_notice
  skip undefined: True
  editable: True
  pdf template file: Publication_Notice_Minor2.pdf
  fields: 
    - "filing_county": ${filing_county}
    - "user_name": ${ users[0].name.full(middle='full')}
    - "case_number": ${""}
    - "child_old_name_1": ${published_children[0].name.full(middle='full')}
    - "child_new_name_1": ${published_children[0].new.name.full(middle='full')}
    - "child_old_name_2": ${published_children[1].name.full(middle='full')}
    - "child_new_name_2": ${published_children[1].new.name.full(middle='full')}
    - "child_old_name_3": ${published_children[2].name.full(middle='full')}
    - "child_new_name_3": ${published_children[2].new.name.full(middle='full')}
    - "child_old_name_4": ${published_children[3].name.full(middle='full')}
    - "child_new_name_4": ${published_children[3].new.name.full(middle='full')}
    - "more_than_four_kids": ${True if published_children.number_gathered() > 4 else False}
    - "court_date": ${""}
    - "court_time": ${""}
    - "court_am": ${False}
    - "court_pm": ${False}
    - "courtroom": ${""}
    - "in_person": ${False}
    #- "courtroom_address": ${courthouse_info}
    - "remote": ${False}
    - "video_website": ${""}
    - "video_log_in": ${""}
    - "call_in_number": ${""}
    - "clerk_phone": ${""}
    - "clerk_website": ${""}
    - "e_signature": ${ users[0].name.full(middle='full') if e_signature == True else ""}
    - "user_address": ${users[0].address.on_one_line(bare=True)}
    - "alternate_address": ${use_safe_address}
    - "user_phone": ${phone_number_formatted(users[0].phone_number)}
    - "user_email": ${users[0].email if users[0].has_email_address == True else ""}
---
objects:
  - children[i].child_information: ALDocument.using(title="Child information", filename="child_information.pdf", has_addendum=False)
  - children[i].parents[j].parent_info_sheet: ALDocument.using(title="Parent information", filename="additional_parent.pdf", has_addendum=False)
  - children[i].additional_criminal_history: ALDocument.using(title="Additional Criminal History", filename="child_name_change_additional_criminal_history.pdf", has_addendum=False)  
  - children[i].motion_to_waive_notice: ALDocument.using(title = "Motion to waive notice and publication", filename="motion_to_waive.pdf", has_addendum=False)
  - children[i].order_to_waive_notice: ALDocument.using(title = "Order on motion to waive notice and publication", filename="order_to_waive_notice.pdf", has_addendum=False, enabled=False)
---
generic object: ALIndividual
objects:
  - x.notice_of_court_date: ALDocument.using(title="Notice of court date", filename="notice_of_court_date.pdf", has_addendum=False)
---
reconsider: True
code: |
  #debug_list.clear()
  
  elements_for_notice_bundle = []
  
  if parent_list_generator.number_gathered() > 0:
    for index, person in enumerate(parent_list_generator):
      if (index % 3) == 0:
        person.notice_of_court_date.enabled = True
        #debug_list.append(person)
        elements_for_notice_bundle.append(person.notice_of_court_date)
        if (index + 1) < parent_list_generator.number_gathered():
          person.second_person = parent_list_generator[index + 1]
        elif defined('person.second_person'):
          undefine('person.second_person')
        if (index + 2) < parent_list_generator.number_gathered():
          person.third_person = parent_list_generator[index + 2]
        elif defined('person.third_person'):
          undefine('person.third_person')
      else:
        person.notice_of_court_date.enabled = False
      
  notice_of_date_bundle.elements = elements_for_notice_bundle
  refresh_notice_bundle = True
---
objects:
  - notice_of_date_bundle: ALDocumentBundle.using(elements=[], title= "Notice of court date", filename="notice_of_court_date.pdf", has_addendum=False, enabled=True)
---
objects:
  - motion_to_waive_bundle: ALDocumentBundle.using(elements=[], title= "Motion to waive notice", filename="motion_to_waive_notice.pdf", has_addendum=False, enabled=True)
  - order_to_waive_bundle: ALDocumentBundle.using(elements=[], title= "Order on motion to waive notice", filename="order_on_motion_to_waive_notice.pdf", has_addendum=False, enabled=True)
---
attachment:
  variable name: children[i].child_information[j]
  name: child_information
  filename: child_information
  skip undefined: True
  editable: False
  pdf template file: Request_for_Name_Change_Child_Information.pdf
  fields: 
    - "filing_county": ${filing_county}
    - "user_name": ${ users[0].name.full(middle='full')}
    - "case_number": ${""}
    - "child_old_first": ${children[i].name.first}
    - "child_old_middle": ${children[i].name.middle}
    - "child_old_last": ${children[i].name.last if children[i].name.suffix == "" else (children[i].name.last + " " + children[i].name.suffix)}
    - "child_birth_date": ${children[i].birthdate}
    - "child_birth_place": ${(children[i].birth_place.city + ", " + end_in_county(children[i].birth_place.county) + ", " + children[i].birth_place.state) if children[i].birth_place.in_america == True else (children[i].birth_place.city + ", " + children[i].birth_place.country)}
    - "child_address": ${users[0].address.on_one_line(bare=True) if children[i].use_safe_address == True else children[i].address.on_one_line(bare=True)}
    - "alternate_address": ${children[i].use_safe_address}
    - "user_is_parent": ${True if children[i].user_relationship == "bio" or children[i].user_relationship == "adopt" else False}
    - "user_is_guardian": ${ True if children[i].user_relationship == "custody" else False}
    - "user_is_recognized": ${ True if children[i].user_relationship == "years" else False}
    - "child_unpardoned_misdemeanor_true": ${True if children[i].misdemeanors == True and children[i].misdemeanor_pardon == False else False}
    - "child_unpardoned_misdemeanor_false": ${False if children[i].misdemeanors == True and children[i].misdemeanor_pardon == False else True}
    - "child_arrest_true": ${ True if children[i].pending_arrests == True else False}
    - "child_arrest_false": ${ True if children[i].pending_arrests == False else False}
    - "child_pending_charge_true": ${ True if children[i].pending_charges == True else False}
    - "child_pending_charge_false": ${ True if children[i].pending_charges == False else False}
    - "child_unpardoned_felony_true": ${True if children[i].felonies == True and children[i].felony_pardon == False else False}
    - "child_unpardoned_felony_false": ${False if children[i].felonies == True and children[i].felony_pardon == False else True}
    - "child_registration_true": ${True if children[i].registry == True else False}
    - "child_registration_false": ${True if children[i].registry == False else False}
    - "marriage_exception": ${True if children[i].registry == True and children[i].registry_exceptions["Marriage"] == True else False}
    - "religious_exception": ${True if children[i].registry == True and children[i].registry_exceptions["Religious beliefs"] == True else False}
    - "victim_exception": ${True if children[i].registry == True and children[i].registry_exceptions["Status as a victim of trafficking"] == True else False}
    - "gender_exception": ${True if children[i].registry == True and children[i].registry_exceptions["Gender-related identity"] == True else False}
    - "child_identity_true": ${ True if children[i].id_theft == True else False}
    - "child_identity_false": ${ True if children[i].id_theft == False else False}
    - "conviction_description_1": ${children[i].convictions[0].name.text}
    - "conviction_date_1": ${ format_date(children[i].convictions[0].date, format='MM/dd/yyyy') }
    - "sentence_1": ${  children[i].convictions[0].sentence}
    - "completion_date_1": ${ format_date(children[i].convictions[0].completed_date, format='MM/dd/yyyy') }
    - "pardoned_1": ${children[i].convictions[0].pardoned}
    - "conviction_description_2": ${children[i].convictions[1].name.text}
    - "conviction_date_2": ${ format_date(children[i].convictions[1].date, format='MM/dd/yyyy') }
    - "sentence_2": ${  children[i].convictions[1].sentence}
    - "completion_date_2": ${ format_date(children[i].convictions[1].completed_date, format='MM/dd/yyyy') }
    - "pardoned_2": ${children[i].convictions[1].pardoned}
    - "conviction_description_3": ${children[i].convictions[2].name.text}
    - "conviction_date_3": ${ format_date(children[i].convictions[2].date, format='MM/dd/yyyy') }
    - "sentence_3": ${  children[i].convictions[2].sentence}
    - "completion_date_3": ${ format_date(children[i].convictions[2].completed_date, format='MM/dd/yyyy') }
    - "pardoned_3": ${children[i].convictions[2].pardoned}
    - "user_wishes": ${True if children[i].change_reasons["user_wants"] == True else False}
    - "child_wishes": ${True if children[i].change_reasons["child_wants"] == True else False}
    - "other_reason_check": ${True if children[i].change_reasons["other"] == True else False}
    - "other_reason_text": ${ children[i].other_reason if children[i].change_reasons["other"] == True else ""}
    - "no_other_parent": |
        % if children[i].include_parents_zero_on_child_sheet:
        ${False}
        % elif children[i].include_main_parent_on_child_sheet:
        ${False}
        % elif children[i].other_parent_status == "deceased_parent":
        ${False}
        % else:
        ${True}
        % endif
    - "dead_other_parent": ${True if children[i].other_parent_status == "deceased_parent" else False}
    #Next field commented out pending SME review  
    #- "terminated_text": ${"(Their rights were terminated by a court order)" if children[i].any_other_parents == True and children[i].parents[0].parent_type == "Parent" and children[i].parents[0].rights_terminated == True else ""}
    - "yes_other_parent": ${True if children[i].include_parents_zero_on_child_sheet == True or children[i].include_main_parent_on_child_sheet == True else False}
    - "other_parent_first": |
        % if children[i].include_main_parent_on_child_sheet == True:
        ${children[i].main_other_parent.name.first}
        % elif children[i].include_parents_zero_on_child_sheet == True:
        ${children[i].parents[0].name.first}
        % else:
        ${""}
        % endif
    - "other_parent_middle": |
        % if children[i].include_main_parent_on_child_sheet == True:
        ${children[i].main_other_parent.name.middle}
        % elif children[i].include_parents_zero_on_child_sheet == True:
        ${children[i].parents[0].name.middle}
        % else:
        ${""}
        % endif
    - "other_parent_last": |
        % if children[i].include_main_parent_on_child_sheet == True:
        % if children[i].main_other_parent.name.suffix == "":
        ${children[i].main_other_parent.name.last}
        % else:
        ${children[i].main_other_parent.name.last} ${children[i].main_other_parent.name.suffix}
        % endif
        % elif children[i].include_parents_zero_on_child_sheet == True:
        % if children[i].parents[0].name.suffix == "":
        ${children[i].parents[0].name.last}
        % else:
        ${children[i].parents[0].name.last} ${children[i].parents[0].name.suffix}
        % endif
        % else:
        ${""}
        % endif
    - "other_parent_address": |
        % if children[i].include_main_parent_on_child_sheet == True:
        % if children[i].main_other_parent.address_known == True:
        ${children[i].main_other_parent.address.on_one_line(bare=True)}
        % else:
        ${"Unknown"}
        % endif
        % elif children[i].include_parents_zero_on_child_sheet == True:
        % if children[i].parents[0].address_known == True:
        ${children[i].parents[0].address.on_one_line(bare=True)}
        % else:
        ${"Unknown"}
        % endif
        % endif
    - "other_parent_name_full": |
        % if children[i].include_main_parent_on_child_sheet == True:
        % if children[i].main_other_parent.agree == True:
        ${children[i].main_other_parent.name.full(middle='full')}
        % else:
        ${""}
        % endif
        % elif children[i].include_parents_zero_on_child_sheet == True:
        % if children[i].parents[0].agree == True:
        ${children[i].parents[0].name.full(middle='full')}
        % else:
        ${""}
        % endif
        % endif
    - "other_parent_disagree": |
        % if children[i].include_main_parent_on_child_sheet == True:
        % if children[i].main_other_parent.agree == False:
        ${True}
        % else:
        ${False}
        % endif
        % elif children[i].include_parents_zero_on_child_sheet == True:
        % if children[i].parents[0].agree == False:
        ${True}
        % else:
        ${False}
        % endif
        % endif
    - "other_parent_dont_know": |
        % if children[i].include_main_parent_on_child_sheet == True:
        % if children[i].main_other_parent.agree is None:
        ${True}
        % else:
        ${False}
        % endif
        % elif children[i].include_parents_zero_on_child_sheet == True:
        % if children[i].parents[0].agree is None:
        ${True}
        % else:
        ${False}
        % endif
        % endif
    - "other_parent_agree": |
        % if children[i].include_main_parent_on_child_sheet == True:
        % if children[i].main_other_parent.agree == True:
        ${True}
        % else:
        ${False}
        % endif
        % elif children[i].include_parents_zero_on_child_sheet == True:
        % if children[i].parents[0].agree == True:
        ${True}
        % else:
        ${False}
        % endif
        % endif
    - "third_parent_false": ${True if children[i].has_guardian == False else False}
    - "third_parent_true": ${children[i].has_guardian}
    - "custodian_true": ${children[i].has_custodian}
    - "custodian_false": ${ True if children[i].has_custodian == False else False}
---
#The fields in this pdf template refer to "user" because it is pulled from the adult name change program. In this program, the form represents the child's additional criminal history, not the user's.
attachment:
  variable name: children[i].additional_criminal_history[j]
  name: addendum
  filename: addendum
  skip undefined: True
  editable: False
  pdf template file: name_change_additional_criminal_history.pdf
  fields:
    - "trial_court_county": ${ filing_county }
    - "user__1": ${ children[i].name.full(middle='full') }
    - "user_offense_name_4": ${ children[i].convictions[3].name.text }
    - "user_conviction_date_4": ${ format_date(children[i].convictions[3].date, format='MM/dd/yyyy') }
    - "user_sentence_4": ${ children[i].convictions[3].sentence }
    - "user_sentence_completed_date_4": ${ format_date(children[i].convictions[3].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_4": |
        % if children[i].convictions[3].name.text != "":
        % if children[i].convictions[3].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_5": ${ children[i].convictions[4].name.text }
    - "user_conviction_date_5": ${ format_date(children[i].convictions[4].date, format='MM/dd/yyyy') }
    - "user_sentence_5": ${ children[i].convictions[4].sentence }
    - "user_sentence_completed_date_5": ${ format_date(children[i].convictions[4].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_5": |
        % if children[i].convictions[4].name.text != "":
        % if children[i].convictions[4].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_6": ${ children[i].convictions[5].name.text }
    - "user_conviction_date_6": ${ format_date(children[i].convictions[5].date, format='MM/dd/yyyy') }
    - "user_sentence_6": ${ children[i].convictions[5].sentence }
    - "user_sentence_completed_date_6": ${ format_date(children[i].convictions[5].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_6": |
        % if children[i].convictions[5].name.text != "":
        % if children[i].convictions[5].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_7": ${ children[i].convictions[6].name.text }
    - "user_conviction_date_7": ${ format_date(children[i].convictions[6].date, format='MM/dd/yyyy') }
    - "user_sentence_7": ${ children[i].convictions[6].sentence }
    - "user_sentence_completed_date_7": ${ format_date(children[i].convictions[6].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_7": |
        % if children[i].convictions[6].name.text != "":
        % if children[i].convictions[6].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_8": ${ children[i].convictions[7].name.text }
    - "user_conviction_date_8": ${ format_date(children[i].convictions[7].date, format='MM/dd/yyyy') }
    - "user_sentence_8": ${ children[i].convictions[7].sentence }
    - "user_sentence_completed_date_8": ${ format_date(children[i].convictions[7].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_8": |
        % if children[i].convictions[7].name.text != "":
        % if children[i].convictions[7].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_9": ${ children[i].convictions[8].name.text }
    - "user_conviction_date_9": ${ format_date(children[i].convictions[8].date, format='MM/dd/yyyy') }
    - "user_sentence_9": ${ children[i].convictions[8].sentence }
    - "user_sentence_completed_date_9": ${ format_date(children[i].convictions[8].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_9": |
        % if children[i].convictions[8].name.text != "":
        % if children[i].convictions[8].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_10": ${ children[i].convictions[9].name.text }
    - "user_conviction_date_10": ${ format_date(children[i].convictions[9].date, format='MM/dd/yyyy') }
    - "user_sentence_10": ${ children[i].convictions[9].sentence }
    - "user_sentence_completed_date_10": ${ format_date(children[i].convictions[9].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_10": |
        % if children[i].convictions[9].name.text != "":
        % if children[i].convictions[9].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_11": ${ children[i].convictions[10].name.text }
    - "user_conviction_date_11": ${ format_date(children[i].convictions[10].date, format='MM/dd/yyyy') }
    - "user_sentence_11": ${ children[i].convictions[10].sentence }
    - "user_sentence_completed_date_11": ${ format_date(children[i].convictions[10].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_11": |
        % if children[i].convictions[10].name.text != "":
        % if children[i].convictions[10].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_12": ${ children[i].convictions[11].name.text }
    - "user_conviction_date_12": ${ format_date(children[i].convictions[11].date, format='MM/dd/yyyy') }
    - "user_sentence_12": ${ children[i].convictions[11].sentence }
    - "user_sentence_completed_date_12": ${ format_date(children[i].convictions[11].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_12": |
        % if children[i].convictions[11].name.text != "":
        % if children[i].convictions[11].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
---
attachment:
  variable name: children[i].parents[j].parent_info_sheet[k]
  name: parent_info_sheet
  filename: parent_info_sheet
  skip undefined: True
  editable: False
  pdf template file: Request_for_Name_Change_Additonal_Parent_Minor.pdf
  fields: 
    - "case_number": ${""}
    - "user_name": ${ users[0].name.full(middle='full')}
    - "filing_county": ${filing_county}
    - "is_parent_or_guardian": ${True if children[i].parents[j].parent_type != "Custodian" else False}
    - "is_custodian": ${True if children[i].parents[j].parent_type == "Custodian" else False}
    - "parental_first": ${children[i].parents[j].name.first}
    - "parental_middle": ${children[i].parents[j].name.middle}
    - "parental_last": ${children[i].parents[j].name.last if children[i].parents[j].name.suffix == "" else (children[i].parents[j].name.last + " " + children[i].parents[j].name.suffix)}
    - "other_parent_name_full": ${children[i].parents[j].name.full(middle='full') if children[i].parents[j].agree else ""}
    - "parental_address": ${children[i].parents[j].address.on_one_line(bare=True) if children[i].parents[j].address_known else "Unknown"}
    - "certified_or_sheriff": ${True if children[i].parents[j].address_known == True and children[i].parents[j].agree != True else False}
    - "publication_notice": ${children[i].parents[j].publication_needer}
    - "rights_terminated": ${True if children[i].parents[j].parent_type == "Parent" and children[i].parents[j].rights_terminated == True else False}
    - "disagrees": ${ True if children[i].parents[j].agree == False else False}
    - "dont_know": ${True if children[i].parents[j].agree is None else False}
    - "agrees": ${children[i].parents[j].agree}

---
#The next questions will be in the shared yml, this is for testing purposes
id: criminal history intro
generic object: ALPeopleList
continue button field: x[i].criminal_history_intro
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Criminal history
    % else:
    Spouse's criminal history
    % endif
  % else:
  Criminal history
  % endif
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    To request a name change in Illinois, you need to tell the court about any criminal history you may have.
    % else:
    To request a name change in Illinois, your spouse needs to tell the court about any criminal history they may have.
    % endif
  % else:
    To request a name change for a child, you must tell the court about any criminal history the child may have.
  % endif
  
  Having any criminal history does not prevent a person from getting a legal name change. Only certain offenses can affect the name change request. The next screens will guide you through the process.
---
id: pending arrests
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any arrests for which charges have not been filed?
    % else:
    Does your spouse have any arrests for which charges have not been filed?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}) have any arrests for which charges have not been filed?
  % endif
subquestion: |
  % if interview_type == 'adult':
  If you were arrested but did not go to court or see a judge, then you were probably not charged with a crime. That means charges are pending.
  % else:
  If ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}) was arrested but did not go to court or see a judge, then they were probably not charged with a crime. That means charges are pending.
  % endif
fields:
  - no label: x[i].pending_arrests
    datatype: yesnoradio
---
id: pending charges
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any pending misdemeanor or felony charges?
    % else:
    Does your spouse have any pending misdemeanor or felony charges?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}) have any pending misdemeanor or felony charges?
  % endif
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    In other words, do you have any ongoing criminal cases against you for misdemeanor or felony offenses?
    % else:
    In other words, does your spouse have any ongoing criminal cases against them for misdemeanor or felony offenses?
    % endif
  % else:
    In other words, does ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}) have any ongoing criminal cases against them for misdemeanor or felony offenses?
  % endif
fields:
  - no label: x[i].pending_charges
    datatype: yesnoradio
---
id: misdemeanors
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any convictions or were you placed on probation for any misdemeanors?
    % else:
    Does your spouse have any convictions or were they placed on probation for any misdemeanors?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}) have any misdemeanor convictions or were they placed on probation for any misdemeanors?
  % endif
subquestion: |
  These can be misdemeanors in Illinois or any other state.
fields:
  - no label: x[i].misdemeanors
    datatype: yesnoradio
  - Were all of these misdemeanors pardoned?: x[i].misdemeanor_pardon
    datatype: yesnoradio
    show if:
      variable: x[i].misdemeanors
      is: True
---
id: felonies
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any convictions or were you placed on probation for any felonies?
    % else:
    Does your spouse have any convictions or were they placed on probation for any felonies?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}) have any felony convictions or were they placed on probation for any felonies?
  % endif
subquestion: |
  These can be felonies in Illinois or any other state.
fields:
  - no label: x[i].felonies
    datatype: yesnoradio
  - Were all of these felonies pardoned?: x[i].felony_pardon
    datatype: yesnoradio
    show if:
      variable: x[i].felonies
      is: True
---
id: registries
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any convictions or were you placed on probation for a crime that required you register?
    % else:
    Does your spouse have any convictions or were they placed on probation for a crime that required them to register?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}) have any convictions or were they placed on probation for a crime that required them register?
  % endif
subquestion: |
  These include crimes that require registration under the:
  
  * Sex Offender Registration Act
  * Murderer and Violent Offender Against Youth Act, or
  * Arsonist Registration Act.

  % if interview_type == 'adult':
    % if i == 0:
    **Important**: If you were placed on any of these registries and have not been pardoned, **you should not file a petition to change your name** unless one of these exceptions apply:
    % else:
    **Important**: If they were placed on any of these registries and have not been pardoned, **you should not file a petition to change your name** unless one of these exceptions apply:
    % endif
  % else:
  **Important**: If they were placed on any of these registries and have not been pardoned, **you should not file a petition to change their name** unless one of these exceptions apply:
  % endif
  
  * Marriage
  * Religious beliefs
  * Status as a victim of trafficking
  * **{Gender-related identity}**

  These can be Illinois registries or similar registries in any other state. If none of these restrictions apply and you still want to change their name, you may want to speak to a lawyer. Use [**Get Legal Help**](https://www.illinoislegalaid.org/get-legal-help) to find free or low-cost legal services in your area.
fields:
  - no label: x[i].registry
    datatype: yesnoradio
  - Which of these exceptions apply?: x[i].registry_exceptions
    datatype: checkboxes
    choices:
      - Marriage: Marriage 
      - Religious beliefs: Religious beliefs
      - Status as a victim of trafficking: Status as a victim of trafficking
      - Gender-related identity: Gender-related identity
    show if:
      variable: x[i].registry
      is: True
---
terms:
  - "Gender-related identity": |
      The Illinois Human Rights Act states that gender-identity does not need to be the same as the  sex designated at birth.
  - "Offenses requiring registration": |
      These include crimes that require registration under the:
  
       * Sex Offender Registration Act
       * Murderer and Violent Offender Against Youth Act, or
       * Arsonist Registration Act.
---
id: registry notification requirement info
continue button field: registry_notification
question: |
  Notify law enforcement after a name change if required to register
subquestion: |
  Anyone who is required to register and is granted a legal name change must notify the law enforcement agency with whom they are registered of the name change.

  Notification deadlines depend on the type of registration:

  * Sex Offender Registration Act - notify within 3 days
  * Murderer and Violent Offender Against Youth Act - notify within 5 days
  * Arsonist Registration Act - notify within 10 days
---
id: id theft
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any convictions or were you placed on probation for identity theft?
    % else:
    Does your spouse have any convictions or were they placed on probation for identity theft?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}) have any convictions or were they placed on probation for identity theft?
  % endif
subquestion: |
  This includes **identity theft** or **aggravated identity theft**.
  
  These can be in Illinois or any other state.

  % if interview_type == 'adult':
    % if i == 0:
    You can still request a name change even if you answer **Yes**.
    % else:
    Your spouse can still request a name change even if you answer **Yes**.
    % endif
  % else:
  You can still request a name change for ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}) even if you answer **Yes**.
  % endif
fields:
  - no label: x[i].id_theft
    datatype: yesnoradio
---
id: conviction intro
generic object: ALPeopleList
continue button field: x[i].conviction_intro
question: |
  Criminal history details
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    For these convictions or probations, you must enter more information on your name change request:
    % else:
    For these convictions or probations, you must enter more information on your spouse's name change request:
    % endif
  % else:
  For these convictions or probations of ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}), you must enter more information:
  % endif

  % if x[i].felonies:
   * Felony convictions or probations
  % endif
  % if x[i].registry:
   * **{Offenses requiring registration}**
  % endif
  % if x[i].id_theft:
   * Identification theft or Aggravated identity theft
  % endif

---
id: conviction details
generic object: ALPeopleList
question: |
  % if j == 0:
  Conviction or probation details
  % else:
  More conviction or probation details
  % endif
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    For any of the following convictions or probations, you must enter more information on your name change request:
    % else:
    For any of the following convictions or probations, you must enter more information on your spouse's name change request:
    % endif
  % else:
  For any of the following convictions or probations of ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}), you must enter more information:
  % endif
  
  % if x[i].felonies:
   * Felony convictions or probations
  % endif
  % if x[i].registry:
   * **{Offenses requiring registration}**
  % endif
  % if x[i].id_theft:
   * Identification theft or Aggravated identity theft
  % endif
fields:
  - Offense description: x[i].convictions[j].name.text
    input type: area
    rows: 2
    maxlength: 75
  - Date of conviction or probation: x[i].convictions[j].date
    datatype: date
    max: ${ today().format("yyyy-MM-dd") }
    min: |
      % if interview_type == 'adult':
      ${today().minus(years=110)}
      % else:
      ${x[i].birthdate}
      % endif
  - Sentence received: x[i].convictions[j].sentence
    input type: area
    rows: 2
    maxlength: 75
  - Date sentence completed: x[i].convictions[j].completed_date
    datatype: date
    max: ${ today().format("yyyy-MM-dd") }
    min: |
      % if interview_type == 'adult':
      ${today().minus(years=110)}
      % else:
      ${x[i].birthdate}
      % endif
  - Pardoned?: x[i].convictions[j].pardoned
    datatype: yesnoradio
validation code: |
  if x[i].convictions[j].completed_date < x[i].convictions[j].date:
    validation_error("Date sentence completed must be on or after date of conviction or probation. Please adjust your answers.", field="x[i].convictions[j].completed_date")
  if j > 10:
    x[i].convictions.there_is_another = False
---
id: any other convictions
generic object: ALPeopleList
question: |
  Are there other convictions or probations?
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    For any of the following convictions or probations, you must enter more information on your name change request:
    % else:
    For any of the following convictions or probations, you must enter more information on your spouse's name change request:
    % endif
  % else:
  For these convictions or probations of ${x[i].new.name.full(middle='full')} (${x[i].name.full(middle='full')}), you must enter more information on your name change request:
  % endif

  % if x[i].felonies:
   * Felony convictions or probations
  % endif
  % if x[i].registry:
   * **{Offenses requiring registration}**
  % endif
  % if x[i].id_theft:
   * Identification theft or Aggravated identity theft
  % endif
  
  % if x[i].convictions.number() == 1:
  You can enter up to 12 convictions or probations in total. So far you have told us about ${ x[i].convictions.number() } offense:
  % else:
  You can enter up to 12 convictions or probations in total. So far you have told us about ${ x[i].convictions.number() } offenses:
  % endif
  
  % for conviction in x[i].convictions:
   * ${conviction.name.text} on ${conviction.date}
  % endfor
fields:
  - "Add another conviction or probation?": x[i].convictions.there_is_another
    datatype: yesnoradio
---
id: children there is another
question: |
  Do you want to change the name of another child?
subquestion: |
  So far you have told us about: 
  
  % for child in children:
  * ${child.new.name.full(middle='full')} (${child.name.full(middle='full')})
  % endfor
fields:
  - no label: children.there_is_another
    datatype: yesnoradio
---
id: parents there is another
question: |
  Does ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')}) have another parent, guardian, or custodian?
subquestion: |
  % if children[i].no_main_parent == False:
  So far you have told us about ${comma_and_list(children[i].main_other_parent, children[i].parents)}.
  % else:
  So far you have told us about ${comma_and_list(children[i].parents)}.
  % endif
fields:
  - no label: children[i].parents.there_is_another
    datatype: yesnoradio
---
id: registry kickout
event: registry_kickout
question: |
  Sorry
subquestion: |
  A person who committed crimes that require registration and is not pardoned cannot request a name change with this program.
  
  These include crimes that require registration under the:
  
  * Sex Offender Registration Act
  * Murderer and Violent Offender Against Youth Act, or
  * Arsonist Registration Act.
  
  Click **Back** if you made a mistake. Or you can talk with a lawyer to discuss your options. Use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
buttons:
  - Exit: exit
  - Restart: restart
---
id: review screen
event: review_answers
question: |
  Review screen
subquestion: |
  % if waiver_reason_logic:
  Edit your answers below.
  % else:
  Edit your answers below.
  % endif
review: 
  - Edit: started_living_in_illinois
    button: |
      **When did you start living in Illinois?**
      ${started_living_in_illinois}
  - Edit: users[0].name.first
    button: |
      **Your name:**
      ${users[0].name.full(middle='full')}
  - Edit: use_safe_address 
    button: |
      **Do you want to use an alternate mailing address?**
      ${word(yesno(use_safe_address))}
  - Edit: users[0].address.address
    button: |
      % if use_safe_address == True:
      **Alternate mailing address:**
      % else:
      **Your address:**
      % endif
      ${users[0].address.on_one_line(bare=True)}
  - Edit: users[0].has_email_address
    button: |
      **Your contact information:**
      % if users[0].phone_number != "" and users[0].has_email_address == True:
      
      * Phone number: ${phone_number_formatted(users[0].phone_number)}
      * Email address: ${users[0].email}
      % elif users[0].phone_number != "" and users[0].has_email_address == False:
      ${phone_number_formatted(users[0].phone_number)}
      % elif users[0].phone_number == "" and users[0].has_email_address == True:
      ${users[0].email}
      % endif
  - Edit: children.revisit
    button: |
      **Children: (Edit to change names, addresses, and other guardians)**

      % for my_var in children:
        * ${ my_var.new.name.full(middle="full")} (${my_var.name.full(middle='full')})
      % endfor
  - label: Edit
    fields:
      - trial_court_index
      - recompute:
        - filing_county
    button: |
      **Which county are you filing the name change in?**
      ${end_in_county(filing_county)}
  #- Edit: cook_district
  #  button: |
  #    **In which Cook County courthouse is your case?**
  #    % if cook_district == "15":
  #    First Municipal District, Daley Center, 50 W. Washington Street, Chicago
  #    % elif cook_district == "16":
  #    Second Municipal District, 5600 Old Orchard Road, Skokie
  #    % elif cook_district == "17":
  #    Third Municipal District, 2121 Euclid Avenue, Rolling Meadows
  #    % elif cook_district == "18":
  #    Fourth Municipal District, 1500 Maybrook Drive, Maywood
  #    % elif cook_district == "19":
  #    Fifth Municipal District, 10220 S. 76th Avenue, Bridgeview
  #    % elif cook_district == "20":
  #    Sixth Municipal District, 16501 South Kedzie Parkway, Markham
  #    % endif
  #  show if: trial_court_index == -1 and child_notice_would_be_published == True and (any_risk == True or request_waiver == False)
  - Edit: e_signature
    button: |
      **Do you want to add your e-signature to your forms?**
      ${word(yesno(e_signature))}
---
section: Notice
id: notice review screen
event: section_notice
question: |
  Notice
subquestion: |
  % if waiver_reason_logic:
  Edit your answers below.
  % else:
  Edit your answers below.
  % endif
review:
  - Edit: children.revisit
    button: |
      **Children: (Edit to change if and how you will give parents and guardians notice )**

      % for my_var in children:
        * ${ my_var.new.name.full(middle="full")} (${my_var.name.full(middle='full')})
      % endfor
---
section: Children and parents
id: children review screen
event: section_children
question: |
  Children and parents information
subquestion: |
  Edit your answers below.
  
  ${ children.table }
  
  ${ children.add_action() }
review:
  - Edit: users[0].name.first
    button: |
      **Your name:**
      ${users[0].name.full(middle='full')}
    show if: users[0].name.first == "This is just included so the Children review screen can have the table and the resume button"
  #- Edit: children.revisit
  #  button: |
  #    **Children: (Edit to change names, addresses, and other guardians)**
#
  #    % for my_var in children:
  #      * ${ my_var.new.name.full(middle="full")} (${my_var.name.full(middle='full')})
  #    % endfor
---
id: children review screen
continue button field: children.revisit
question: |
  Edit the information about the children
subquestion: |
  ${ children.table }
  
  ${ children.add_action() }
---
id: parents review
continue button field: children[i].parents.revisit
question: |
  Edit the information about ${children[i].new.name.full(middle='full')} (${children[i].name.full(middle='full')})'s parents, guardians, and custodians
subquestion: |
  ${ children[i].parents.table }
  
  ${ children[i].parents.add_action() }
---
id: children table
table: children.table
rows: children
columns:
  - Current name: |
      row_item.name.full(middle="full") if defined("row_item.name.first") else ""
  - New name, address, criminal records, and other guardians: |
      action_button_html(url_action(row_item.attr_name("review_child")), label="Edit", icon="pencil-alt")
delete buttons: True
confirm: True
---
#action_button_html(url_action(row_item.attr_name("review_parent")), label="Edit", icon="pencil-alt")
id: parent table
table: children[i].parents.table
rows: children[i].parents
columns:
  - Name: |
      row_item.name.full(middle='full') if defined("row_item.name.first") else ""
  - Address and other information: |
      action_button_html(url_action(row_item.attr_name("review_parent")), label="Edit", icon="pencil-alt")
delete buttons: True
confirm: True
---
id: child review screen
continue button field: x.review_child
generic object: ALIndividual
question: |
  Edit ${x.new.name.full(middle='full')} (${x.name.full(middle='full')})'s information
review: 
  - note: |
      #### ${x.new.name.full(middle='full')} (${x.name.full(middle='full')})'s identity
  - Edit: x.name.first
    button: |
      **Current name:**
      ${x.name.full(middle='full')}
  - Edit: x.new.name.first
    button: |
      **New name:**
      ${x.new.name.full(middle='full')}
  - Edit: x.birthdate
    button: |
      **Birth date:**
      ${x.birthdate}
  - Edit: x.six_months_in_illinois
    button: |
      **Has ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) lived in Illinois for at least 6 months?**
      ${word(yesno(x.six_months_in_illinois))}
  - Edit: x.user_relationship
    button: |
      **Your relationship to ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}):**
      % if x.user_relationship == "bio":
      Biological parent
      % elif x.user_relationship == "adopt":
      Adoptive parent
      % elif x.user_relationship == "custody":
      Legal guardian
      % elif x.user_relationship == "years":
      They have lived in my home for 3 years and are recognized as my adopted child.
      % elif x.user_relationship == "other":
      Other
      % endif
  - Edit: x.no_parental_rights
    button: |
      **Were your parental rights over ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) terminated?**
      ${word(yesno(x.no_parental_rights))}
    show if: x.user_relationship == "bio" or x.user_relationship == "adopt"
  - Edit: x.change_reasons
    button: |
      **Why are you changing this child's name from "${x.name.full(middle='full')}" to "${x.new.name.full(middle='full')}?"**
      
      % if x.change_reasons['user_wants']:
      * I want to change their name.
      % endif
      % if x.change_reasons['child_wants']:
      * They want to change their name.
      % endif
      % if x.change_reasons['other']:
      * ${x.other_reason}
      % endif
  - Edit: x.birth_place.in_america
    button: |
      **${x.new.name.full(middle='full')} (${x.name.full(middle='full')})'s birth place:**
      % if x.birth_place.in_america == True:
      ${x.birth_place.city}, ${end_in_county(x.birth_place.county)}, ${x.birth_place.state}
      % else:
      ${x.birth_place.city}, ${x.birth_place.country}
      % endif
  - Edit: x.use_safe_address
    button: |
      **Do you want to use ${users[0].address.on_one_line(bare=True)} as ${x.new.name.full(middle='full')} (${x.name.full(middle='full')})'s address?**
      ${word(yesno(x.use_safe_address))}
    show if: use_safe_address 
  - Edit: x.address.address
    button: |
      **${x.new.name.full(middle='full')} (${x.name.full(middle='full')})'s address:**
      ${x.address.on_one_line(bare=True)}
    #show if: showifdef('x.use_safe_address') != True
  - note: |
      #### ${x.new.name.full(middle='full')} (${x.name.full(middle='full')})'s criminal history
  - Edit: x.pending_arrests
    button: |
      **Does ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have any arrests for which charges have not been filed?**
      ${word(yesno(x.pending_arrests))}
  - Edit: x.pending_charges
    button: |
      **Does ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have any pending misdemeanor or felony charges?**
      ${word(yesno(x.pending_charges))}
  - Edit: x.misdemeanors
    button: |
      **Does ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have any misdemeanor convictions or were they placed on probation for any misdemeanors?**
      % if x.misdemeanors == False:
      No
      % else:
      % if x.misdemeanor_pardon == True:
      Yes, and they have been pardoned of them.
      % else:
      Yes, and they have not been pardoned for all of them.
      % endif
      % endif
  - Edit: x.felonies
    button: |
      **Does ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have any felony convictions or were they placed on probation for any felonies?**
      % if x.felonies == False:
      No
      % else:
      % if x.felony_pardon == True:
      Yes, and they have been pardoned of them.
      % else:
      Yes, and they have not been pardoned for all of them.
      % endif
      % endif
  - Edit: x.registry
    button: |
      **Do ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have any convictions or were they placed on probation for a crime that required them register?**
      % if x.registry == False:
      No
      % elif x.registry_exceptions.all_false():
      Yes
      % else:
      Yes, but the following exception or exceptions apply:
      
      % if x.registry_exceptions['Marriage']:
      * Marriage
      % endif
      % if x.registry_exceptions['Religious beliefs']:
      * Religious beliefs
      % endif
      % if x.registry_exceptions['Status as a victim of trafficking']:
      * Status as a victim of trafficking
      % endif
      % if x.registry_exceptions['Gender-related identity']:
      * Gender-related identity
      % endif
      % endif
  - Edit: x.id_theft
    button: |
      **Does ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have any convictions or were they placed on probation for identity theft?**
      ${word(yesno(x.id_theft))}
  - Edit: x.convictions.revisit
    button: |
      **${x.new.name.full(middle='full')} (${x.name.full(middle='full')})'s convictions: (Edit to change details)**

      % for my_var in x.convictions:
        * ${ my_var.name.text } on ${ my_var.date }
      % endfor
  - note: |
      #### ${x.new.name.full(middle='full')} (${x.name.full(middle='full')})'s other parent
  #- Edit: x.no_main_parent
  #  button: |
  #    **Does ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have a parent other than you?**
  #    % if x.no_main_parent == False:
  #    Yes
  #    % else:
  #    No
  #    % endif
  - Edit: x.other_parent_status
    button: |
      **Does ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have a parent other than you?**
      % if x.other_parent_status == "has_other_parent":
      Yes
      % elif x.other_parent_status == "deceased_parent":
      No, their other parent has passed away.
      % else:
      No
      % endif
  - Edit: x.main_other_parent.name.first
    button: |
      **Other parent's name:**
      ${x.main_other_parent.name.full(middle='full')}
    show if: x.no_main_parent == False
  - Edit: x.main_other_parent.rights_terminated
    button: |
      **Were ${x.main_other_parent.name.full(middle='full')}'s parental rights terminated?**
      ${word(yesno(x.main_other_parent.rights_terminated))}
    show if: x.no_main_parent == False
  - Edit: x.main_other_parent.agree
    button: |
      **Does ${x.main_other_parent.name.full(middle='full')} agree to the name change?**
      % if x.main_other_parent.agree != True and x.main_other_parent.agree != False:
      I don't know
      % else:
      ${word(yesno(x.main_other_parent.agree))}
      % endif
    show if: x.no_main_parent == False and x.main_other_parent.rights_terminated == False
  - Edit: x.main_other_parent.address_known
    button: |
      **Do you know ${x.main_other_parent.name.full(middle='full')}'s address?**
      ${word(yesno(x.main_other_parent.address_known))}
    show if: x.no_main_parent == False
  - Edit: x.main_other_parent.address.address
    button: |
      **${x.main_other_parent.name.full(middle='full')}'s address:**
      ${x.main_other_parent.address.on_one_line(bare=True)}
    show if: x.no_main_parent == False and x.main_other_parent.address_known == True
  - Edit: x.main_other_parent.risk_check 
    button: |
      **Are you worried that giving notice to ${x.main_other_parent.name.full(middle='full')} of the name change request would put your child at risk?**
      ${word(yesno(x.main_other_parent.risk_check))}
    show if: x.no_main_parent == False and x.main_other_parent.agree != True
  - Edit: x.main_other_parent.receive_method
    button: |
      **How will you give ${x.main_other_parent.name.full(middle='full')} notice of this name change request?**
      % if x.receive_method == "mail":
      I will give notice of this Request and the scheduled court date by certified mail.
      % elif x.receive_method == "sheriff":
      I will give notice of this Request and the scheduled court date by service of process by sheriff.
      % elif x.receive_method == "newspaper":
      I will publish notice of this Request in a local newspaper.
      % endif
    show if: x.no_main_parent == False and x.main_other_parent.agree != True and x.main_other_parent.risk_check == False
  - note: |
      #### Other parents, guardians, and custodians
  - Edit: x.any_other_parents
    button: |
      % if x.no_main_parent == False:
      **Does ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have any other parents, guardians, or custodians?**
      % else:
      **Does ${x.new.name.full(middle='full')} (${x.name.full(middle='full')}) have any guardians or custodians other than you?**
      % endif
      ${word(yesno(x.any_other_parents))}
  - Edit: x.parents.revisit
    button: |
      % if x.no_main_parent == False:
      **Other parents, guardians, and custodians: (Edit to change names, addresses, and other information)**
      % else:
      **Guardians and custodians: (Edit to change names, addresses, and other information)**
      % endif
      
      % for my_var in x.parents:
        * ${ my_var.name.full(middle="full")}
      % endfor
    show if: x.any_other_parents
  - note: |
      #### Notice and waiver (if applicable)
  - Edit: x.request_waiver
    button: |
      **Are you concerned publishing notice of ${x.new.name.full(middle='full')} (${x.name.full(middle='full')})'s name change would put them at risk?**
      ${word(yesno(x.request_waiver))}
    #show if: x.child_notice_would_be_published == True
  - Edit:  x.waiver_reason
    button: |
      **Why do you need a notice waiver?**
      
      % if x.waiver_reason['order'] == True:
      * I have or did have protection from a court order.
      % endif
      % if x.waiver_reason['hardship'] == True:
      * I need a waiver of notice and publication of name change because it would be a hardship for the person who is changing their name.
      % endif
    #show if: x.any_risk == True or (x.child_notice_would_be_published == True and x.request_waiver == True)
  - Edit:  x.protective_order
    button: |
      **What kind of court protection do or did you have?**
      
      % if x.protective_order['op'] == True:
      * An Order of Protection
      % endif
      % if x.protective_order['snco'] == True:
      * A Stalking No Contact Order
      % endif
      % if x.protective_order['cnco'] == True:
      * A Civil No Contact Order
      % endif
      % if x.protective_order['other_criminal'] == True:
      * A Protective order in someone else's criminal case
      % endif
      % if x.protective_order['bail'] == True:
      * Being a protected person under someone else's bail conditions
      % endif
      % if x.protective_order['other_order'] == True:
      * A similar protective order in ${x.other_order_state}
      % endif
    #show if: x.waiver_reason['order'] == True and (x.any_risk == True or (x.child_notice_would_be_published == True and x.request_waiver == True))
  - Edit: x.order_against_parents
    button: |
       **Is the protective order against another parent, guardian, or custodian?**
       ${word(yesno(x.order_against_parents))}
    #show if: x.protective_order.any_true() == True and (x.waiver_reason['order'] == True and (x.any_risk == True or (x.child_notice_would_be_published == True and x.request_waiver == True))) 
  - Edit: x.orders.revisit
    button: |
      **Protective orders: (Edit to change details)**

      % for my_var in x.orders:
        * ${ my_var.number } in ${ my_var.name.text }, ${ my_var.state }
      % endfor
  - Edit: x.hardship_text
    button: |
      **Notice and publication would be a hardship because:**
      ${x.hardship_text}
    #show if: x.any_risk == True or (x.child_notice_would_be_published == True and x.request_waiver == True)
---
id: protective orders review screen
continue button field: children[i].orders.revisit
question: |
  Edit the protective orders
subquestion: |
  ${ children[i].orders.table }

  % if children[i].orders.number_gathered() < 4:
  ${ children[i].orders.add_action() }
  % endif
---
table: children[i].orders.table
rows: children[i].orders
columns:
  - Case number: |
      row_item.number if defined("row_item.name.text") else ""
  - County: |
      row_item.name.text if defined("row_item.name.text") else ""
  - State: |
      row_item.state if defined("row_item.name.text") else ""
edit:
  - name.text
delete buttons: True
confirm: True
---
id: convictions revisit
continue button field: children[i].convictions.revisit
question: |
  Edit the convictions
subquestion: |
  ${ children[i].convictions.table }

  % if children[i].convictions.number_gathered() < 12:
  ${ children[i].convictions.add_action() }
  % endif
---
table: children[i].convictions.table
rows: children[i].convictions
columns:
  - Offense description: |
      row_item.name.text if defined("row_item.name.text") else ""
  - Details (including dates, sentences, and pardons): |
      action_button_html(url_action(row_item.attr_name("review_convictions_details")), label="Edit", icon="pencil-alt")
delete buttons: True
confirm: True
---
id: edit convictions
continue button field: x.review_convictions_details
generic object: DAObject
question: |
  Edit conviction details
review: 
  - Edit: x.name.text
    button: |
      **Offense description:**
      ${ x.name.text  }
  - Edit: x.date
    button: |
      **Date of conviction or probation:**
      ${ x.date } 
  - Edit: x.sentence
    button: |
      **Sentence received:**
      ${ x.sentence }
  - Edit: x.pardoned
    button: |
      **Pardoned?**
      ${ word(yesno(x.pardoned)) }
continue button label: Next
---
id: parent review
continue button field: x.review_parent
generic object: ALIndividual
question: |
  Edit ${x.name.full(middle='full')}'s information
review: 
  - note: |
      #### About ${x.name.full(middle='full')}
  - Edit: x.name.first
    button: |
      **Name of parent, guardian, or custodian:**
      ${x.name.full(middle='full')}   
  - Edit: x.parent_type
    button: |
      **Is ${x.name.full(middle='full')} a parent, guardian, or custodian?**
      ${x.parent_type}
  - Edit: x.rights_terminated
    button: |
      **Were ${x.name.full(middle='full')}'s parental rights terminated?**
      ${word(yesno(x.rights_terminated))}
    show if: x.parent_type == "Parent"
  - Edit: x.agree
    button: |
      **Does ${x.name.full(middle='full')} agree to the name change?**
      % if x.agree != True and x.agree != False:
      I don't know
      % else:
      ${word(yesno(x.agree))}
      % endif
  - note: |
      #### Notice
  - Edit: x.address_known
    button: |
      **Do you know ${x.name.full(middle='full')}'s address?**
      ${word(yesno(x.address_known))}
  - Edit: x.address.address
    button: |
      **${x.name.full(middle='full')}'s address:**
      ${x.address.on_one_line(bare=True)}
    show if: x.address_known == True
  - Edit: x.risk_check 
    button: |
      **Are you worried that giving notice to ${x.name.full(middle='full')} of the name change request would put your child at risk?**
      ${word(yesno(x.risk_check))}
    show if: x.agree != True
  - Edit: x.receive_method
    button: |
      **How will you give ${x.name.full(middle='full')} notice of this name change request?**
      % if x.receive_method == "mail":
      I will give notice of this Request and the scheduled court date by certified mail.
      % elif x.receive_method == "sheriff":
      I will give notice of this Request and the scheduled court date by service of process by sheriff.
      % elif x.receive_method == "newspaper":
      I will publish notice of this Request in a local newspaper.
      % endif
    show if: x.agree != True and x.risk_check == False
---
section: Your information
id: user review screen
event: section_user
question: |
  Your information
subquestion: |
  Edit your answers below.
review:
  - Edit: started_living_in_illinois
    button: |
      **When did you start living in Illinois?**
      ${started_living_in_illinois}
  - Edit: users[0].name.first
    button: |
      **Your name:**
      ${users[0].name.full(middle='full')}
  - Edit: use_safe_address 
    button: |
      **Do you want to use an alternate mailing address?**
      ${word(yesno(use_safe_address))}
  - Edit: users[0].address.address
    button: |
      % if use_safe_address == True:
      **Alternate mailing address:**
      % else:
      **Your address:**
      % endif
      ${users[0].address.on_one_line(bare=True)}
  - Edit: users[0].has_email_address
    button: |
      **Your contact information:**
      % if users[0].phone_number != "" and users[0].has_email_address == True:
      
      * Phone number: ${phone_number_formatted(users[0].phone_number)}
      * Email address: ${users[0].email}
      % elif users[0].phone_number != "" and users[0].has_email_address == False:
      ${phone_number_formatted(users[0].phone_number)}
      % elif users[0].phone_number == "" and users[0].has_email_address == True:
      ${users[0].email}
      % endif
---
section: Filing
id: filing review screen
event: section_filing
question: |
  Filing information
subquestion: |
  Edit your answers below.
review:
  - label: Edit
    fields:
      - trial_court_index
      - recompute:
        - filing_county
    button: |
      **Which county are you filing the name change in?**
      ${end_in_county(filing_county)}
  #- Edit: cook_district
  #  button: |
  #    **In which Cook County courthouse is your case?**
  #    % if cook_district == "15":
  #    First Municipal District, Daley Center, 50 W. Washington Street, Chicago
  #    % elif cook_district == "16":
  #    Second Municipal District, 5600 Old Orchard Road, Skokie
  #    % elif cook_district == "17":
  #    Third Municipal District, 2121 Euclid Avenue, Rolling Meadows
  #    % elif cook_district == "18":
  #    Fourth Municipal District, 1500 Maybrook Drive, Maywood
  #    % elif cook_district == "19":
  #    Fifth Municipal District, 10220 S. 76th Avenue, Bridgeview
  #    % elif cook_district == "20":
  #    Sixth Municipal District, 16501 South Kedzie Parkway, Markham
  #    % endif
  #  show if: trial_court_index == -1 and child_notice_would_be_published == True and (any_risk == True or request_waiver == False)
  - Edit: e_signature
    button: |
      **Do you want to add your e-signature to your forms?**
      ${word(yesno(e_signature))}